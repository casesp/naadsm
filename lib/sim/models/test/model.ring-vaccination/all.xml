<deterministic-test>
  <category>ring-vaccination</category>
  <short-name>0 km radius</short-name>

  <description>
    Test a scenario with 0 km radius ring vaccination.  No units will be
    vaccinated.
  </description>

  <author>Neil Harvey &lt;neilharvey@gmail.com&gt;</author>
  <creation-date>2 December 2003</creation-date>
  <model-version>3.0</model-version>

  <herd-file>16herds_square</herd-file>

  <parameter-file>radius_0</parameter-file>

  <parameter-description>
    The latent period lasts 1 day, infectiousness lasts 2 days, clinical signs
    accompany infectiousness immediately, and natural immunity lasts 3 days.
    
    The probability of detection vs. the number of days a unit has been showing
    clinical signs is fixed at 1.  The probability of detection vs. the number
    of days since a public announcement of an outbreak is also fixed at 1.
    
    The vaccine produces immunity immediately, and the immunity lasts 3 days.
    The authorities can vaccinate an unlimited/very large number of units each
    day.

    There is no spread or destruction.
  </parameter-description>

  <output>
    <tr><td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Latent</td>              <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td></tr>
    <tr><td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>InfectiousClinical</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td></tr>
    <tr><td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>InfectiousClinical</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td></tr>
    <tr><td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>NaturallyImmune</td>     <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td></tr>
<!--
    No infectious units, simulation stops.
-->
  </output>
</deterministic-test>

<deterministic-test>
  <category>ring-vaccination</category>
  <short-name>0.5 km radius</short-name>

  <description>
    Run again, but with 0.5 km radius ring vaccination.  The closest units are
    1 km away, so again no units will be vaccinated.
  </description>

  <author>Neil Harvey &lt;neilharvey@gmail.com&gt;</author>
  <creation-date>2 December 2003</creation-date>
  <model-version>3.0</model-version>

  <herd-file>16herds_square</herd-file>

  <parameter-file>radius_0.5</parameter-file>

  <parameter-description>
    The latent period lasts 1 day, infectiousness lasts 2 days, clinical signs
    accompany infectiousness immediately, and natural immunity lasts 3 days.
    
    The probability of detection vs. the number of days a unit has been showing
    clinical signs is fixed at 1.  The probability of detection vs. the number
    of days since a public announcement of an outbreak is also fixed at 1.
    
    The vaccine produces immunity immediately, and the immunity lasts 3 days.
    The authorities can vaccinate an unlimited/very large number of units each
    day.

    There is no spread or destruction.
  </parameter-description>

  <output>
    <tr><td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Latent</td>              <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td></tr>
    <tr><td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>InfectiousClinical</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td></tr>
    <tr><td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>InfectiousClinical</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td></tr>
    <tr><td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>NaturallyImmune</td>     <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td></tr>
<!--
    No infectious units, simulation stops.
-->
  </output>
</deterministic-test>

<deterministic-test>
  <category>ring-vaccination</category>
  <short-name>1 km radius</short-name>

  <description>
    Run again, but with 1 km radius ring vaccination.  Units 2, 5, 7, and 10
    should be vaccinated.
  </description>

  <author>Neil Harvey &lt;neilharvey@gmail.com&gt;</author>
  <creation-date>2 December 2003</creation-date>
  <model-version>3.0</model-version>

  <herd-file>16herds_square</herd-file>

  <parameter-file>radius_1</parameter-file>

  <parameter-description>
    The latent period lasts 1 day, infectiousness lasts 2 days, clinical signs
    accompany infectiousness immediately, and natural immunity lasts 3 days.
    
    The probability of detection vs. the number of days a unit has been showing
    clinical signs is fixed at 1.  The probability of detection vs. the number
    of days since a public announcement of an outbreak is also fixed at 1.
    
    The vaccine produces immunity immediately, and the immunity lasts 3 days.
    The authorities can vaccinate an unlimited/very large number of units each
    day.

    There is no spread or destruction.
  </parameter-description>

  <output>
    <tr><td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>    <td>Latent</td>              <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td></tr>
    <tr><td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>    <td>InfectiousClinical</td>  <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td></tr>
    <tr><td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>    <td>InfectiousClinical</td>  <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td></tr>
    <tr><td>Susceptible</td>  <td>Susceptible</td>  <td>VaccineImmune</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>VaccineImmune</td>  <td>NaturallyImmune</td>     <td>VaccineImmune</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>VaccineImmune</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td></tr>
<!--
    No infectious units, simulation stops.
-->
  </output>
</deterministic-test>

<deterministic-test>
  <category>ring-vaccination</category>
  <short-name>2.5 km radius</short-name>

  <description>
    Run again, but with 2.5 km radius ring vaccination.  All units except 12
    should be vaccinated.
  </description>

  <author>Neil Harvey &lt;neilharvey@gmail.com&gt;</author>
  <creation-date>2 December 2003</creation-date>
  <model-version>3.0</model-version>

  <herd-file>16herds_square</herd-file>

  <parameter-file>radius_2.5</parameter-file>

  <parameter-description>
    The latent period lasts 1 day, infectiousness lasts 2 days, clinical signs
    accompany infectiousness immediately, and natural immunity lasts 3 days.
    
    The probability of detection vs. the number of days a unit has been showing
    clinical signs is fixed at 1.  The probability of detection vs. the number
    of days since a public announcement of an outbreak is also fixed at 1.
    
    The vaccine produces immunity immediately, and the immunity lasts 3 days.
    The authorities can vaccinate an unlimited/very large number of units each
    day.

    There is no spread or destruction.
  </parameter-description>

  <output>
    <tr><td>Susceptible</td>    <td>Susceptible</td>    <td>Susceptible</td>    <td>Susceptible</td>    <td>Susceptible</td>    <td>Susceptible</td>    <td>Latent</td>              <td>Susceptible</td>    <td>Susceptible</td>    <td>Susceptible</td>    <td>Susceptible</td>    <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td>    <td>Susceptible</td>    <td>Susceptible</td></tr>
    <tr><td>Susceptible</td>    <td>Susceptible</td>    <td>Susceptible</td>    <td>Susceptible</td>    <td>Susceptible</td>    <td>Susceptible</td>    <td>InfectiousClinical</td>  <td>Susceptible</td>    <td>Susceptible</td>    <td>Susceptible</td>    <td>Susceptible</td>    <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td>    <td>Susceptible</td>    <td>Susceptible</td></tr>
    <tr><td>Susceptible</td>    <td>Susceptible</td>    <td>Susceptible</td>    <td>Susceptible</td>    <td>Susceptible</td>    <td>Susceptible</td>    <td>InfectiousClinical</td>  <td>Susceptible</td>    <td>Susceptible</td>    <td>Susceptible</td>    <td>Susceptible</td>    <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td>    <td>Susceptible</td>    <td>Susceptible</td></tr>
    <tr><td>VaccineImmune</td>  <td>VaccineImmune</td>  <td>VaccineImmune</td>  <td>VaccineImmune</td>  <td>VaccineImmune</td>  <td>VaccineImmune</td>  <td>NaturallyImmune</td>     <td>VaccineImmune</td>  <td>VaccineImmune</td>  <td>VaccineImmune</td>  <td>VaccineImmune</td>  <td>VaccineImmune</td>  <td>Susceptible</td>  <td>VaccineImmune</td>  <td>VaccineImmune</td>  <td>VaccineImmune</td></tr>
<!--
    No infectious units, simulation stops.
-->
  </output>
</deterministic-test>

<deterministic-test>
  <category>ring-vaccination</category>
  <short-name>1 km radius, vaccine takes effect in 1 day</short-name>

  <description>
    Run again, but with 1 km radius ring vaccination and a 1 day delay for
    vaccination to take effect.
  </description>

  <author>Neil Harvey &lt;neilharvey@gmail.com&gt;</author>
  <creation-date>2 December 2003</creation-date>
  <model-version>3.0</model-version>

  <herd-file>16herds_square</herd-file>

  <parameter-file>radius_1_delay_1</parameter-file>

  <parameter-description>
    The latent period lasts 1 day, infectiousness lasts 3 days, clinical signs
    accompany infectiousness immediately, and natural immunity lasts 3 days.
    
    The probability of detection vs. the number of days a unit has been showing
    clinical signs is fixed at 1.  The probability of detection vs. the number
    of days since a public announcement of an outbreak is also fixed at 1.
    
    The vaccine requires 1 day to produce immunity, and the immunity lasts 3
    days.  The authorities can vaccinate an unlimited/very large number of
    units each day.

    There is no spread or destruction.
  </parameter-description>

  <output>
    <tr><td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>    <td>Latent</td>              <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td></tr>
    <tr><td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>    <td>InfectiousClinical</td>  <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td></tr>
    <tr><td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>    <td>InfectiousClinical</td>  <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td></tr>
    <tr><td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>    <td>InfectiousClinical</td>  <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td></tr>
    <tr><td>Susceptible</td>  <td>Susceptible</td>  <td>VaccineImmune</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>VaccineImmune</td>  <td>NaturallyImmune</td>     <td>VaccineImmune</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>VaccineImmune</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td></tr>
<!--
    No infectious units, simulation stops.
-->
  </output>
</deterministic-test>

<deterministic-test>
  <category>ring-vaccination</category>
  <short-name>1 km radius, vaccine takes effect in 2 days</short-name>

  <description>
    Run again, but with 1 km radius ring vaccination and a 2 day delay for
    vaccination to take effect.
  </description>

  <author>Neil Harvey &lt;neilharvey@gmail.com&gt;</author>
  <creation-date>2 December 2003</creation-date>
  <model-version>3.0</model-version>

  <herd-file>16herds_square</herd-file>

  <parameter-file>radius_1_delay_2</parameter-file>

  <parameter-description>
    The latent period lasts 1 day, infectiousness lasts 4 days, clinical signs
    accompany infectiousness immediately, and natural immunity lasts 3 days.
    
    The probability of detection vs. the number of days a unit has been showing
    clinical signs is fixed at 1.  The probability of detection vs. the number
    of days since a public announcement of an outbreak is also fixed at 1.

    The vaccine requires 2 days to produce immunity, and the immunity lasts 3
    days.  The authorities can vaccinate an unlimited/very large number of
    units each day.

    There is no spread or destruction.
  </parameter-description>

  <output>
    <tr><td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>    <td>Latent</td>              <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td></tr>
    <tr><td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>    <td>InfectiousClinical</td>  <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td></tr>
    <tr><td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>    <td>InfectiousClinical</td>  <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td></tr>
    <tr><td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>    <td>InfectiousClinical</td>  <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td></tr>
    <tr><td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>    <td>InfectiousClinical</td>  <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td></tr>
    <tr><td>Susceptible</td>  <td>Susceptible</td>  <td>VaccineImmune</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>VaccineImmune</td>  <td>NaturallyImmune</td>     <td>VaccineImmune</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>VaccineImmune</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td></tr>
<!--
    No infectious units, simulation stops.
-->
  </output>
</deterministic-test>

<stochastic-test>
  <category>ring-vaccination</category>
  <short-name>infection vs. vaccination on same day</short-name>

  <description>
    Test the choice of whether infection or vaccination takes effect when both
    happen on the same day.  The two outcomes should be chosen with equal
    probability.    
  </description>

  <author>Neil Harvey &lt;neilharvey@gmail.com&gt;</author>
  <creation-date>20 March 2004</creation-date>
  <model-version>3.0</model-version>

  <herd-file>2herds</herd-file>
  
  <parameter-file>spread_radius_10</parameter-file>

  <parameter-description>
    The latent period lasts 1 day, infectiousness lasts 3 days, clinical signs
    accompany infectiousness immediately, and natural immunity lasts 3 days.

    The movement rate is fixed at 1 shipment each day.  The distance of
    shipments is fixed at 10 km, and the delay is 1 day.  Latent units cannot
    be the source of an exposure.  The probability of infection given exposure
    is 1.
    
    The probability of detection vs. the number of days a unit has been showing
    clinical signs is fixed at 1.  The probability of detection vs. the number
    of days since a public announcement of an outbreak is also fixed at 1.
    
    The vaccine produces immunity immediately, and the immunity lasts 3 days.
    The authorities can vaccinate an unlimited/very large number of units each
    day.
    
    There is no destruction.

    What should happen:
     - On day 1 unit 0 will be Latent.
     - On day 2 unit 0 will be Infectious Clinical.  It will ship to unit 1.
       Unit 0 will be detected, and unit 1 will be marked for vaccination.
     - On day 3 the shipment will arrive at unit 1 and unit 1 will be
       vaccinated.  Half of the time the vaccination will happen "first" and
       the other half of the time the infection will happen "first".
     - On day 4 unit 1 will be either Latent or Vaccine Immune.
  </parameter-description>

  <!-- probability that unit becomes Vaccine Immune = probability that the
    vaccination happens "before" the infection (0.5). -->
  <output probability="0.5">
    <tr><td>Latent</td>              <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>VaccineImmune</td></tr>
  </output>

  <!-- probability that unit become Latent = probability that the infection
    happens "before" the vaccination (0.5). -->
  <output probability="0.5">
    <tr><td>Latent</td>              <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>Latent</td></tr>
  </output>
</stochastic-test>

<stochastic-variable-test>
  <category>ring-vaccination</category>
  <short-name>infection vs. vaccination on same day, check reporting variables</short-name>

  <description>
    Test the reporting of the number of new infections when infection and
    vaccination (with immediate effect) happen on the same day.  If the
    vaccination happens "first", the infection should not be recorded.
  </description>

  <author>Neil Harvey &lt;neilharvey@gmail.com&gt;</author>
  <creation-date>10 September 2007</creation-date>
  <model-version>3.0</model-version>

  <herd-file>2herds</herd-file>
  
  <parameter-file>spread_radius_10_w_vars</parameter-file>

  <parameter-description>
    The latent period lasts 1 day, infectiousness lasts 3 days, clinical signs
    accompany infectiousness immediately, and natural immunity lasts 3 days.

    The movement rate is fixed at 1 shipment each day.  The distance of
    shipments is fixed at 10 km, and the delay is 1 day.  Latent units cannot
    be the source of an exposure.  The probability of infection given exposure
    is 1.
    
    The probability of detection vs. the number of days a unit has been showing
    clinical signs is fixed at 1.  The probability of detection vs. the number
    of days since a public announcement of an outbreak is also fixed at 1.
    
    The vaccine produces immunity immediately, and the immunity lasts 3 days.
    The authorities can vaccinate an unlimited/very large number of units each
    day.
    
    There is no destruction.

    What should happen:
     - On day 1 unit 0 will be Latent.
     - On day 2 unit 0 will be Infectious Clinical.  It will ship to unit 1.
       Unit 0 will be detected, and unit 1 will be marked for vaccination.
     - On day 3 the shipment will arrive at unit 1 and unit 1 will be
       vaccinated.  Half of the time the vaccination will happen "first" and
       the other half of the time the infection will happen "first".
     - On day 4 unit 1 will be either Latent or Vaccine Immune.
  </parameter-description>

  <!-- probability that unit becomes Vaccine Immune = probability that the
    vaccination happens "before" the infection (0.5). -->
  <output probability="0.5">
    <tr>
      <td>num-units-infected-by-cause:initially infected</td>
      <td>num-units-vaccinated</td>
      <td>num-units-exposed-by-cause:Direct Contact</td>
      <td>num-units-infected-by-cause:Direct Contact</td>
    </tr>
    <tr><td>1</td>  <td>0</td>  <td>0</td>  <td>0</td></tr>
    <tr><td>0</td>  <td>0</td>  <td>0</td>  <td>0</td></tr>
    <tr><td>0</td>  <td>1</td>  <td>1</td>  <td>0</td></tr>
  </output>

  <!-- probability that unit becomes Latent = probability that the infection
    happens "before" the vaccination (0.5). -->
  <output probability="0.5">
    <tr>
      <td>num-units-infected-by-cause:initially infected</td>
      <td>num-units-vaccinated</td>
      <td>num-units-exposed-by-cause:Direct Contact</td>
      <td>num-units-infected-by-cause:Direct Contact</td>
    </tr>
    <tr><td>1</td>  <td>0</td>  <td>0</td>  <td>0</td></tr>
    <tr><td>0</td>  <td>0</td>  <td>0</td>  <td>0</td></tr>
    <tr><td>0</td>  <td>1</td>  <td>1</td>  <td>1</td></tr>
  </output>
</stochastic-variable-test>

<deterministic-test>
  <category>ring-vaccination</category>
  <short-name>unchecked spread 1 km</short-name>

  <description>
    Test a scenario where the disease is spreading.  Use airborne spread with
    infection certain at 1 km but prevent spread farther than 1 km.

    In this first test there is no vaccination, to confirm that spread acts as
    we expect.  The disease should spread every second day because of the 1 day
    latent period.  It should spread outward in a ring; the immunity period
    should prevent spread back inward.  So:
    
    units 2, 5, 7, and 10 should become infected on day 2

    units 1, 3, 4, 9, 11, and 14 should become infected on day 4
    
    units 0, 8, 13, and 16 should become infected on day 6

    unit 12 should become infected on day 8    
  </description>

  <author>Neil Harvey &lt;neilharvey@gmail.com&gt;</author>
  <creation-date>2 December 2003</creation-date>
  <model-version>3.0</model-version>

  <herd-file>16herds_square</herd-file>

  <parameter-file>spread</parameter-file>

  <parameter-description>
    The latent period lasts 1 day, infectiousness lasts 2 days, clinical signs
    accompany infectiousness immediately, and natural immunity lasts 3 days.

    The probability of airborne spread at 1 km is 0.505, and the maximum
    distance of airborne spread is 25 km.

    There is no detection, vaccination, or destruction.
  </parameter-description>

  <output>
    <tr><td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Latent</td>              <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td></tr>
    <tr><td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>InfectiousClinical</td>  <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td></tr>
    <tr><td>Susceptible</td>         <td>Susceptible</td>         <td>Latent</td>              <td>Susceptible</td>         <td>Susceptible</td>         <td>Latent</td>              <td>InfectiousClinical</td>  <td>Latent</td>              <td>Susceptible</td>         <td>Susceptible</td>         <td>Latent</td>              <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td></tr>
    <tr><td>Susceptible</td>         <td>Susceptible</td>         <td>InfectiousClinical</td>  <td>Susceptible</td>         <td>Susceptible</td>         <td>InfectiousClinical</td>  <td>NaturallyImmune</td>     <td>InfectiousClinical</td>  <td>Susceptible</td>         <td>Susceptible</td>         <td>InfectiousClinical</td>  <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td></tr>
    <tr><td>Susceptible</td>         <td>Latent</td>              <td>InfectiousClinical</td>  <td>Latent</td>              <td>Latent</td>              <td>InfectiousClinical</td>  <td>NaturallyImmune</td>     <td>InfectiousClinical</td>  <td>Susceptible</td>         <td>Latent</td>              <td>InfectiousClinical</td>  <td>Latent</td>              <td>Susceptible</td>         <td>Susceptible</td>         <td>Latent</td>              <td>Susceptible</td></tr>
    <tr><td>Susceptible</td>         <td>InfectiousClinical</td>  <td>NaturallyImmune</td>     <td>InfectiousClinical</td>  <td>InfectiousClinical</td>  <td>NaturallyImmune</td>     <td>NaturallyImmune</td>     <td>NaturallyImmune</td>     <td>Susceptible</td>         <td>InfectiousClinical</td>  <td>NaturallyImmune</td>     <td>InfectiousClinical</td>  <td>Susceptible</td>         <td>Susceptible</td>         <td>InfectiousClinical</td>  <td>Susceptible</td></tr>
    <tr><td>Latent</td>              <td>InfectiousClinical</td>  <td>NaturallyImmune</td>     <td>InfectiousClinical</td>  <td>InfectiousClinical</td>  <td>NaturallyImmune</td>     <td>Susceptible</td>         <td>NaturallyImmune</td>     <td>Latent</td>              <td>InfectiousClinical</td>  <td>NaturallyImmune</td>     <td>InfectiousClinical</td>  <td>Susceptible</td>         <td>Latent</td>              <td>InfectiousClinical</td>  <td>Latent</td></tr>
    <tr><td>InfectiousClinical</td>  <td>NaturallyImmune</td>     <td>NaturallyImmune</td>     <td>NaturallyImmune</td>     <td>NaturallyImmune</td>     <td>NaturallyImmune</td>     <td>Susceptible</td>         <td>NaturallyImmune</td>     <td>InfectiousClinical</td>  <td>NaturallyImmune</td>     <td>NaturallyImmune</td>     <td>NaturallyImmune</td>     <td>Susceptible</td>         <td>InfectiousClinical</td>  <td>NaturallyImmune</td>     <td>InfectiousClinical</td></tr>
    <tr><td>InfectiousClinical</td>  <td>NaturallyImmune</td>     <td>Susceptible</td>         <td>NaturallyImmune</td>     <td>NaturallyImmune</td>     <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>InfectiousClinical</td>  <td>NaturallyImmune</td>     <td>Susceptible</td>         <td>NaturallyImmune</td>     <td>Latent</td>              <td>InfectiousClinical</td>  <td>NaturallyImmune</td>     <td>InfectiousClinical</td></tr>
    <tr><td>NaturallyImmune</td>     <td>NaturallyImmune</td>     <td>Susceptible</td>         <td>NaturallyImmune</td>     <td>NaturallyImmune</td>     <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>NaturallyImmune</td>     <td>NaturallyImmune</td>     <td>Susceptible</td>         <td>NaturallyImmune</td>     <td>InfectiousClinical</td>  <td>NaturallyImmune</td>     <td>NaturallyImmune</td>     <td>NaturallyImmune</td></tr>
    <tr><td>NaturallyImmune</td>     <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>NaturallyImmune</td>     <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>InfectiousClinical</td>  <td>NaturallyImmune</td>     <td>Susceptible</td>         <td>NaturallyImmune</td></tr>
    <tr><td>NaturallyImmune</td>     <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>NaturallyImmune</td>     <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>NaturallyImmune</td>     <td>NaturallyImmune</td>     <td>Susceptible</td>         <td>NaturallyImmune</td></tr>
  </output>
</deterministic-test>

<deterministic-test>
  <category>ring-vaccination</category>
  <short-name>spread 1 km + 1 km radius vaccination</short-name>

  <description>
    Run again, but with 1 km ring vaccination and a 1-day delay for vaccine to
    take effect.  This should not prevent spread.  When the index unit (6) is
    diagnosed, its immediate neighbours (units 2, 5, 7, and 10) will be
    vaccinated.  But they will be infected on that same day, so by the next day
    they will already be latent.
  </description>

  <author>Neil Harvey &lt;neilharvey@gmail.com&gt;</author>
  <creation-date>2 December 2003</creation-date>
  <model-version>3.0</model-version>

  <herd-file>16herds_square</herd-file>

  <parameter-file>spread_radius_1</parameter-file>

  <parameter-description>
    The latent period lasts 1 day, infectiousness lasts 2 days, clinical signs
    accompany infectiousness immediately, and natural immunity lasts 3 days.

    The probability of airborne spread at 1 km is 0.505, and the maximum
    distance of airborne spread is 25 km.
    
    The probability of detection vs. the number of days a unit has been showing
    clinical signs is fixed at 1.  The probability of detection vs. the number
    of days since a public announcement of an outbreak is also fixed at 1.

    The vaccine requires 1 day to produce immunity, and the immunity lasts 3
    days.  The authorities can vaccinate an unlimited/very large number of
    units each day.
    
    There is no destruction.
  </parameter-description>

  <output>
    <tr><td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Latent</td>              <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td></tr>
    <tr><td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>InfectiousClinical</td>  <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td></tr>
    <tr><td>Susceptible</td>         <td>Susceptible</td>         <td>Latent</td>              <td>Susceptible</td>         <td>Susceptible</td>         <td>Latent</td>              <td>InfectiousClinical</td>  <td>Latent</td>              <td>Susceptible</td>         <td>Susceptible</td>         <td>Latent</td>              <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td></tr>
    <tr><td>Susceptible</td>         <td>Susceptible</td>         <td>InfectiousClinical</td>  <td>Susceptible</td>         <td>Susceptible</td>         <td>InfectiousClinical</td>  <td>NaturallyImmune</td>     <td>InfectiousClinical</td>  <td>Susceptible</td>         <td>Susceptible</td>         <td>InfectiousClinical</td>  <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td></tr>
    <tr><td>Susceptible</td>         <td>Latent</td>              <td>InfectiousClinical</td>  <td>Latent</td>              <td>Latent</td>              <td>InfectiousClinical</td>  <td>NaturallyImmune</td>     <td>InfectiousClinical</td>  <td>Susceptible</td>         <td>Latent</td>              <td>InfectiousClinical</td>  <td>Latent</td>              <td>Susceptible</td>         <td>Susceptible</td>         <td>Latent</td>              <td>Susceptible</td></tr>
    <tr><td>Susceptible</td>         <td>InfectiousClinical</td>  <td>NaturallyImmune</td>     <td>InfectiousClinical</td>  <td>InfectiousClinical</td>  <td>NaturallyImmune</td>     <td>NaturallyImmune</td>     <td>NaturallyImmune</td>     <td>Susceptible</td>         <td>InfectiousClinical</td>  <td>NaturallyImmune</td>     <td>InfectiousClinical</td>  <td>Susceptible</td>         <td>Susceptible</td>         <td>InfectiousClinical</td>  <td>Susceptible</td></tr>
    <tr><td>Latent</td>              <td>InfectiousClinical</td>  <td>NaturallyImmune</td>     <td>InfectiousClinical</td>  <td>InfectiousClinical</td>  <td>NaturallyImmune</td>     <td>Susceptible</td>         <td>NaturallyImmune</td>     <td>Latent</td>              <td>InfectiousClinical</td>  <td>NaturallyImmune</td>     <td>InfectiousClinical</td>  <td>Susceptible</td>         <td>Latent</td>              <td>InfectiousClinical</td>  <td>Latent</td></tr>
    <tr><td>InfectiousClinical</td>  <td>NaturallyImmune</td>     <td>NaturallyImmune</td>     <td>NaturallyImmune</td>     <td>NaturallyImmune</td>     <td>NaturallyImmune</td>     <td>Susceptible</td>         <td>NaturallyImmune</td>     <td>InfectiousClinical</td>  <td>NaturallyImmune</td>     <td>NaturallyImmune</td>     <td>NaturallyImmune</td>     <td>Susceptible</td>         <td>InfectiousClinical</td>  <td>NaturallyImmune</td>     <td>InfectiousClinical</td></tr>
    <tr><td>InfectiousClinical</td>  <td>NaturallyImmune</td>     <td>Susceptible</td>         <td>NaturallyImmune</td>     <td>NaturallyImmune</td>     <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>InfectiousClinical</td>  <td>NaturallyImmune</td>     <td>Susceptible</td>         <td>NaturallyImmune</td>     <td>Latent</td>              <td>InfectiousClinical</td>  <td>NaturallyImmune</td>     <td>InfectiousClinical</td></tr>
    <tr><td>NaturallyImmune</td>     <td>NaturallyImmune</td>     <td>Susceptible</td>         <td>NaturallyImmune</td>     <td>NaturallyImmune</td>     <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>NaturallyImmune</td>     <td>NaturallyImmune</td>     <td>Susceptible</td>         <td>NaturallyImmune</td>     <td>InfectiousClinical</td>  <td>NaturallyImmune</td>     <td>NaturallyImmune</td>     <td>NaturallyImmune</td></tr>
    <tr><td>NaturallyImmune</td>     <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>NaturallyImmune</td>     <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>InfectiousClinical</td>  <td>NaturallyImmune</td>     <td>Susceptible</td>         <td>NaturallyImmune</td></tr>
    <tr><td>NaturallyImmune</td>     <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>NaturallyImmune</td>     <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>NaturallyImmune</td>     <td>NaturallyImmune</td>     <td>Susceptible</td>         <td>NaturallyImmune</td></tr>
  </output>
</deterministic-test>

<deterministic-test>
  <category>ring-vaccination</category>
  <short-name>spread 1 km + 2.5 km radius vaccination</short-name>

  <description>
    Run again, but with 2.5 km ring vaccination.  This will not prevent spread,
    but it will protect units 0, 8, 13, and 16 by the time the infection gets
    to them.  Unit 12 is outside the 2.5 km radius, so it will not be
    vaccinated in the first round, but once the secondary infections are
    detected, it too will be vaccinated.
  </description>

  <author>Neil Harvey &lt;neilharvey@gmail.com&gt;</author>
  <creation-date>2 December 2003</creation-date>
  <model-version>3.0</model-version>

  <herd-file>16herds_square</herd-file>

  <parameter-file>spread_radius_2.5</parameter-file>

  <parameter-description>
    The latent period lasts 1 day, infectiousness lasts 2 days, clinical signs
    accompany infectiousness immediately, and natural immunity lasts 3 days.

    The probability of airborne spread at 1 km is 0.505, and the maximum
    distance of airborne spread is 25 km.
    
    The probability of detection vs. the number of days a unit has been showing
    clinical signs is fixed at 1.  The probability of detection vs. the number
    of days since a public announcement of an outbreak is also fixed at 1.

    The vaccine requires 1 day to produce immunity, and the immunity lasts 3
    days.  The authorities can vaccinate an unlimited/very large number of
    units each day.
    
    There is no destruction.
  </parameter-description>

  <output>
    <tr><td>Susceptible</td>    <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Latent</td>              <td>Susceptible</td>         <td>Susceptible</td>    <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>    <td>Susceptible</td>    <td>Susceptible</td>         <td>Susceptible</td></tr>
    <tr><td>Susceptible</td>    <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>InfectiousClinical</td>  <td>Susceptible</td>         <td>Susceptible</td>    <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>         <td>Susceptible</td>    <td>Susceptible</td>    <td>Susceptible</td>         <td>Susceptible</td></tr>
    <tr><td>Susceptible</td>    <td>Susceptible</td>         <td>Latent</td>              <td>Susceptible</td>         <td>Susceptible</td>         <td>Latent</td>              <td>InfectiousClinical</td>  <td>Latent</td>              <td>Susceptible</td>    <td>Susceptible</td>         <td>Latent</td>              <td>Susceptible</td>         <td>Susceptible</td>    <td>Susceptible</td>    <td>Susceptible</td>         <td>Susceptible</td></tr>
    <tr><td>Susceptible</td>    <td>Susceptible</td>         <td>InfectiousClinical</td>  <td>Susceptible</td>         <td>Susceptible</td>         <td>InfectiousClinical</td>  <td>NaturallyImmune</td>     <td>InfectiousClinical</td>  <td>Susceptible</td>    <td>Susceptible</td>         <td>InfectiousClinical</td>  <td>Susceptible</td>         <td>Susceptible</td>    <td>Susceptible</td>    <td>Susceptible</td>         <td>Susceptible</td></tr>
    <tr><td>VaccineImmune</td>  <td>Latent</td>              <td>InfectiousClinical</td>  <td>Latent</td>              <td>Latent</td>              <td>InfectiousClinical</td>  <td>NaturallyImmune</td>     <td>InfectiousClinical</td>  <td>VaccineImmune</td>  <td>Latent</td>              <td>InfectiousClinical</td>  <td>Latent</td>              <td>Susceptible</td>    <td>VaccineImmune</td>  <td>Latent</td>              <td>VaccineImmune</td></tr>
    <tr><td>VaccineImmune</td>  <td>InfectiousClinical</td>  <td>NaturallyImmune</td>     <td>InfectiousClinical</td>  <td>InfectiousClinical</td>  <td>NaturallyImmune</td>     <td>NaturallyImmune</td>     <td>NaturallyImmune</td>     <td>VaccineImmune</td>  <td>InfectiousClinical</td>  <td>NaturallyImmune</td>     <td>InfectiousClinical</td>  <td>Susceptible</td>    <td>VaccineImmune</td>  <td>InfectiousClinical</td>  <td>VaccineImmune</td></tr>
    <tr><td>VaccineImmune</td>  <td>InfectiousClinical</td>  <td>NaturallyImmune</td>     <td>InfectiousClinical</td>  <td>InfectiousClinical</td>  <td>NaturallyImmune</td>     <td>Susceptible</td>         <td>NaturallyImmune</td>     <td>VaccineImmune</td>  <td>InfectiousClinical</td>  <td>NaturallyImmune</td>     <td>InfectiousClinical</td>  <td>VaccineImmune</td>  <td>VaccineImmune</td>  <td>InfectiousClinical</td>  <td>VaccineImmune</td></tr>
    <tr><td>Susceptible</td>    <td>NaturallyImmune</td>     <td>NaturallyImmune</td>     <td>NaturallyImmune</td>     <td>NaturallyImmune</td>     <td>NaturallyImmune</td>     <td>Susceptible</td>         <td>NaturallyImmune</td>     <td>Susceptible</td>    <td>NaturallyImmune</td>     <td>NaturallyImmune</td>     <td>NaturallyImmune</td>     <td>VaccineImmune</td>  <td>Susceptible</td>    <td>NaturallyImmune</td>     <td>Susceptible</td></tr>
<!--
    No infectious units, simulation stops.
-->
  </output>
</deterministic-test>

<deterministic-test>
  <category>ring-vaccination</category>
  <short-name>different production types, same parameters</short-name>

  <description>
    Test a scenario with two production types with the same vaccine parameters.
    In this scenario, a sheep unit is initially infected, and when it is
    detected, the nearby cattle and pig units should be vaccinated.
  </description>

  <author>Neil Harvey &lt;neilharvey@gmail.com&gt;</author>
  <creation-date>19 July 2004</creation-date>
  <model-version>3.0</model-version>

  <herd-file>3herds_pigs_cattle_sheep_sheep_infected</herd-file>

  <parameter-file>2species_same_params</parameter-file>

  <parameter-description>
    For sheep (unit 0), the latent period lasts 1 day, infectiousness lasts 5
    days, clinical signs accompany infectiousness immediately, and immunity
    lasts 3 days.  No parameters are set for the disease in cattle or pigs.

    There is no spread.
    
    The probability of detecting diseased sheep vs. the number of days they
    have been showing clinical signs is fixed at 1. The probability of
    detecting diseased sheep vs. the number of days since a public announcement
    of an outbreak is also fixed at 1.  No parameters are set for detecting
    diseased cattle or pigs.

    The authorities will vaccinate cattle and pig units within 20 km of a
    diseased sheep unit.  The vaccine produces immunity immediately, and the
    immunity lasts 3 days.  The authorities can vaccinate an unlimited/very
    large number of units each day.

    There is no destruction.

    Recapping what should happen as a result of all this:
    &lt;ul&gt;
      &lt;li&gt; On day 2 unit 0 (sheep) will be detected and units 1 and 2
        will be slated for vaccination.
      &lt;li&gt; On day 3 units 1 and 2 will be vaccinated.
      &lt;li&gt; Starting on day 4 and ending on day 6, units 1 and 2 will be
        immune.
    &lt;/ul&gt;  
  </parameter-description>

  <output>
    <tr><td>Latent</td>              <td>Susceptible</td>    <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>Susceptible</td>    <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>Susceptible</td>    <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>VaccineImmune</td>  <td>VaccineImmune</td></tr>
    <tr><td>InfectiousClinical</td>  <td>VaccineImmune</td>  <td>VaccineImmune</td></tr>
    <tr><td>InfectiousClinical</td>  <td>VaccineImmune</td>  <td>VaccineImmune</td></tr>
    <tr><td>NaturallyImmune</td>     <td>Susceptible</td>    <td>Susceptible</td></tr>
<!--
    No infectious units, simulation stops.
-->
  </output>
</deterministic-test>

<deterministic-test>
  <category>ring-vaccination</category>
  <short-name>different production types, different parameters</short-name>

  <description>
    Test a scenario with two production types with different vaccine
    parameters.  In this scenario, a sheep unit is initially infected, and when
    it is detected, the nearby cattle and pig units should be vaccinated.
  </description>

  <author>Neil Harvey &lt;neilharvey@gmail.com&gt;</author>
  <creation-date>19 July 2004</creation-date>
  <model-version>3.0</model-version>

  <herd-file>3herds_pigs_cattle_sheep_sheep_infected</herd-file>

  <parameter-file>2species_diff_params</parameter-file>

  <parameter-description>
    For sheep (unit 0), the latent period lasts 1 day, infectiousness lasts 5
    days, clinical signs accompany infectiousness immediately, and immunity
    lasts 3 days.  No parameters are set for the disease in cattle or pigs.

    There is no spread.
    
    The probability of detecting diseased sheep vs. the number of days they
    have been showing clinical signs is fixed at 1. The probability of
    detecting diseased sheep vs. the number of days since a public announcement
    of an outbreak is also fixed at 1.  No parameters are set for detecting
    diseased cattle or pigs.

    The authorities will vaccinate cattle and pig units within 20 km of a
    diseased sheep unit.  For cattle (unit 1), the vaccine produces immunity
    immediately, and the immunity lasts 3 days.  For pigs (unit 2), the vaccine
    requires 1 day to produce immunity, and the immunity lasts 1 day.  The
    authorities can vaccinate an unlimited/very large number of units each day.

    There is no destruction.

    Recapping what should happen as a result of all this:
    &lt;ul&gt;
      &lt;li&gt; On day 2 unit 0 (sheep) will be detected and units 1 and 2
        will be slated for vaccination.
      &lt;li&gt; On day 3 units 1 and 2 will be vaccinated.
      &lt;li&gt; Starting on day 4 and ending on day 6, unit 1 will be immune.
      &lt;li&gt; For day 5 only, unit 2 will be immune.
    &lt;/ul&gt;  
  </parameter-description>

  <output>
    <tr><td>Latent</td>              <td>Susceptible</td>    <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>Susceptible</td>    <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>Susceptible</td>    <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>VaccineImmune</td>  <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>VaccineImmune</td>  <td>VaccineImmune</td></tr>
    <tr><td>InfectiousClinical</td>  <td>VaccineImmune</td>  <td>Susceptible</td></tr>
    <tr><td>NaturallyImmune</td>     <td>Susceptible</td>    <td>Susceptible</td></tr>
<!--
    No infectious units, simulation stops.
-->
  </output>
</deterministic-test>

<deterministic-test>
  <category>ring-vaccination</category>
  <short-name>re-vaccination 1</short-name>

  <description>
    Test that re-vaccination resets the countdown for returning to susceptible.
    This is a baseline scenario with no re-vaccination.
  </description>

  <author>Neil Harvey &lt;neilharvey@gmail.com&gt;</author>
  <creation-date>31 March 2005</creation-date>
  <model-version>3.0</model-version>

  <herd-file>3herds_pigs_cattle_sheep_pigs_sheep_infected</herd-file>

  <parameter-file>revaccinate_0</parameter-file>

  <parameter-description>
    For pigs (unit 2), the latent period lasts 1 day, infectiousness lasts 6
    days, clinical signs accompany infectiousness immediately, and natural
    immunity lasts 3 days.  For sheep (unit 0), the latent period is 3 days
    longer.

    There is no spread.
    
    The probability of detecting diseased pigs and sheep vs. the number of days
    they have been showing clinical signs is fixed at 1. The probability of
    detecting diseased pigs and sheep vs. the number of days since a public
    announcement of an outbreak is also fixed at 1.  No parameters are set for
    detecting diseased cattle.

    The authorities require 6 days to start up a destruction program, after
    which they can destroy 2 herds per day.  The authorities will vaccinate
    cattle units within 10 km of a detection.  For cattle, the vaccine produces
    immunity immediately, and the immunity lasts 3 days.  The authorities will
    not re-vaccinate a herd for 31 days after a vaccination.

    Recapping what should happen as a result of all this:
    &lt;ul&gt;
      &lt;li&gt; On day 1 units 0 (sheep) and 2 (pigs) will be latent.
      &lt;li&gt; On day 2 unit 2 (pigs) will be Infectious Clinical.  It will
        be detected and marked for destruction.  Unit 1 (cattle) will be
	marked for vaccination because it is within 10 km of unit 2.
      &lt;li&gt; On day 3 unit 1 (cattle) will be vaccinated.
      &lt;li&gt; On day 4 unit 1 (cattle) will be Vaccine Immune.
      &lt;li&gt; On day 5 unit 0 (sheep) will be Infectious Clinical.  It will
        be detected and marked for destruction.  Unit 1 (cattle) will not be
	vaccinated because too few days have passed since the last time.
      &lt;li&gt; On day 6 nothing new will happen.
      &lt;li&gt; On day 7 (3 days after becoming Vaccine Immune) unit 1 will
        return to Susceptible.
      &lt;li&gt; On day 8 (5 days after the first detection) units 0 and 2 will
        be destroyed.
    &lt;/ul&gt;  
  </parameter-description>

  <output>
    <tr><td>Latent</td>              <td>Susceptible</td>    <td>Latent</td></tr>
    <tr><td>Latent</td>              <td>Susceptible</td>    <td>InfectiousClinical</td></tr>
    <tr><td>Latent</td>              <td>Susceptible</td>    <td>InfectiousClinical</td></tr>
    <tr><td>Latent</td>              <td>VaccineImmune</td>  <td>InfectiousClinical</td></tr>
    <tr><td>InfectiousClinical</td>  <td>VaccineImmune</td>  <td>InfectiousClinical</td></tr>
    <tr><td>InfectiousClinical</td>  <td>VaccineImmune</td>  <td>InfectiousClinical</td></tr>
    <tr><td>InfectiousClinical</td>  <td>Susceptible</td>    <td>InfectiousClinical</td></tr>
    <tr><td>InfectiousClinical</td>  <td>Susceptible</td>    <td>NaturallyImmune</td></tr>
    <tr><td>InfectiousClinical</td>  <td>Susceptible</td>    <td>NaturallyImmune</td></tr>
    <tr><td>Destroyed</td>           <td>Susceptible</td>    <td>Destroyed</td></tr>
  </output>
</deterministic-test>

<deterministic-test>
  <category>ring-vaccination</category>
  <short-name>re-vaccination 2</short-name>

  <description>
    Test that re-vaccination resets the countdown for returning to susceptible.
    In this scenario, a herd's immune period is extended by re-vaccination.
  </description>

  <author>Neil Harvey &lt;neilharvey@gmail.com&gt;</author>
  <creation-date>31 March 2005</creation-date>
  <model-version>3.0</model-version>

  <herd-file>3herds_pigs_cattle_sheep_pigs_sheep_infected</herd-file>

  <parameter-file>revaccinate_1</parameter-file>

  <parameter-description>
    For pigs (unit 2), the latent period lasts 1 day, infectiousness lasts 6
    days, clinical signs accompany infectiousness immediately, and natural
    immunity lasts 3 days.  For sheep (unit 0), the latent period is 3 days
    longer.

    There is no spread.
    
    The probability of detecting diseased pigs and sheep vs. the number of days
    they have been showing clinical signs is fixed at 1. The probability of
    detecting diseased pigs and sheep vs. the number of days since a public
    announcement of an outbreak is also fixed at 1.  No parameters are set for
    detecting diseased cattle.

    The authorities require 6 days to start up a destruction program, after
    which they can destroy 2 herds per day.  The authorities will vaccinate
    cattle units within 10 km of a detection.  For cattle, the vaccine produces
    immunity immediately, and the immunity lasts 3 days.  The authorities will
    re-vaccinate a herd if it has been 1 or more days since the last
    vaccination.

    Recapping what should happen as a result of all this:
    &lt;ul&gt;
      &lt;li&gt; On day 1 units 0 (sheep) and 2 (pigs) will be latent.
      &lt;li&gt; On day 2 unit 2 (pigs) will be Infectious Clinical.  It will
        be detected and marked for destruction.  Unit 1 (cattle) will be
	vaccinated because it is within 10 km of unit 2.
      &lt;li&gt; On day 3 unit 1 (cattle) will be Vaccine Immune.
      &lt;li&gt; On day 4 unit 0 (sheep) will be Infectious Clinical.  It will
        be detected and marked for destruction.  Unit 1 (cattle) will be
	re-vaccinated.
      &lt;li&gt; On day 5 nothing new will happen.
      &lt;li&gt; On day 6 nothing new will happen.
      &lt;li&gt; On day 7 (5 days after the first detection) units 0 and 2 will
        be destroyed.
      &lt;li&gt; On day 8 (3 days after its "renewed" immunity period began on
        day 5) unit 1 will return to Susceptible.
    &lt;/ul&gt;  
  </parameter-description>

  <output>
    <tr><td>Latent</td>              <td>Susceptible</td>    <td>Latent</td></tr>
    <tr><td>Latent</td>              <td>Susceptible</td>    <td>InfectiousClinical</td></tr>
    <tr><td>Latent</td>              <td>Susceptible</td>    <td>InfectiousClinical</td></tr>
    <tr><td>Latent</td>              <td>VaccineImmune</td>  <td>InfectiousClinical</td></tr>
    <tr><td>InfectiousClinical</td>  <td>VaccineImmune</td>  <td>InfectiousClinical</td></tr>
    <tr><td>InfectiousClinical</td>  <td>VaccineImmune</td>  <td>InfectiousClinical</td></tr>
    <tr><td>InfectiousClinical</td>  <td>VaccineImmune</td>  <td>InfectiousClinical</td></tr>
    <tr><td>InfectiousClinical</td>  <td>VaccineImmune</td>  <td>NaturallyImmune</td></tr>
    <tr><td>InfectiousClinical</td>  <td>VaccineImmune</td>  <td>NaturallyImmune</td></tr>
    <tr><td>Destroyed</td>           <td>Susceptible</td>    <td>Destroyed</td></tr>
  </output>
</deterministic-test>

<deterministic-test>
  <category>ring-vaccination</category>
  <short-name>none trigger, none vaccinated</short-name>

  <description>
    Test that production types that trigger vaccination rings and production
    types that are vaccinated can be specified independently.  In this baseline
    scenario, no production types trigger vaccination rings and no production
    types are vaccinated.
  </description>

  <author>Neil Harvey &lt;neilharvey@gmail.com&gt;</author>
  <creation-date>3 Nov 2005</creation-date>
  <model-version>3.0</model-version>

  <herd-file>6herds_2</herd-file>

  <parameter-file>none_trigger_none_vacc</parameter-file>

  <parameter-description>
    For all production types, the latent period lasts 1 day, infectiousness
    lasts 3 days, clinical signs accompany infectiousness immediately, and
    natural immunity lasts 3 days.

    There is no spread.
    
    The probability of detecting diseased units vs. the number of days they
    have been showing clinical signs is fixed at 1. The probability of
    detecting diseased units vs. the number of days since a public announcement
    of an outbreak is also fixed at 1.

    The authorities will destroy units that are detected as diseased.  The
    authorities can begin a destruction program immediately.  The authorities
    can destroy an unlimited/very large number of units each day.  There is no
    vaccination.

    Recapping what should happen as a result of all this:
    &lt;ul&gt;
      &lt;li&gt; On day 1 units 0 (cattle) and 1 (pigs) will be latent.
      &lt;li&gt; On day 2 units 0 and 1 will be Infectious Clinical.  They will
        be detected and marked for destruction.
      &lt;li&gt; On day 3 units 0 and 1 will be destroyed.
    &lt;/ul&gt;  
  </parameter-description>

  <output>
    <tr><td>Latent</td>              <td>Latent</td>              <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>InfectiousClinical</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>InfectiousClinical</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td></tr>
    <tr><td>Destroyed</td>           <td>Destroyed</td>           <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td></tr>
  </output>
</deterministic-test>

<deterministic-test>
  <category>ring-vaccination</category>
  <short-name>cattle trigger, cattle vaccinated</short-name>

  <description>
    Test that production types that trigger vaccination rings and production
    types that are vaccinated can be specified independently.  In this
    scenario, only cattle units detected as diseased trigger vaccination rings,
    and only cattle units in the rings are vaccinated.
  </description>

  <author>Neil Harvey &lt;neilharvey@gmail.com&gt;</author>
  <creation-date>3 Nov 2005</creation-date>
  <model-version>3.0</model-version>

  <herd-file>6herds_2</herd-file>

  <parameter-file>cattle_trigger_cattle_vacc</parameter-file>

  <parameter-description>
    For all production types, the latent period lasts 1 day, infectiousness
    lasts 3 days, clinical signs accompany infectiousness immediately, and
    natural immunity lasts 3 days.

    There is no spread.
    
    The probability of detecting diseased units vs. the number of days they
    have been showing clinical signs is fixed at 1. The probability of
    detecting diseased units vs. the number of days since a public announcement
    of an outbreak is also fixed at 1.

    The authorities will destroy units that are detected as diseased.  The
    authorities can begin a destruction program immediately.  The authorities
    can destroy an unlimited/very large number of units each day.  The
    authorities will vaccinate cattle within 1.5 km of a detected cattle unit.
    The vaccine produces immunity immediately, and the immunity lasts 5 days.
    The authorities will not re-vaccinate a unit for 31 days after a
    vaccination.

    Recapping what should happen as a result of all this:
    &lt;ul&gt;
      &lt;li&gt; On day 1 units 0 (cattle) and 1 (pigs) will be latent.
      &lt;li&gt; On day 2 units 0 and 1 will be Infectious Clinical.  They will
        be detected and marked for destruction.  Unit 2 will be marked for
        vaccination because it is a cattle unit within 1.5 km of a detected
        cattle unit.
      &lt;li&gt; On day 3 units 0 and 1 will be destroyed, and unit 2 will be
        vaccinated.
      &lt;li&gt; On day 4 unit 2 will be immune.
    &lt;/ul&gt;  
  </parameter-description>

  <output>
    <tr><td>Latent</td>              <td>Latent</td>              <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>InfectiousClinical</td>  <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>InfectiousClinical</td>  <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td></tr>
    <tr><td>Destroyed</td>           <td>Destroyed</td>           <td>VaccineImmune</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td></tr>
  </output>
</deterministic-test>

<deterministic-test>
  <category>ring-vaccination</category>
  <short-name>cattle trigger, pigs vaccinated</short-name>

  <description>
    Test that production types that trigger vaccination rings and production
    types that are vaccinated can be specified independently.  In this
    scenario, only cattle units detected as diseased trigger vaccination rings,
    and only pig units in the rings are vaccinated.
  </description>

  <author>Neil Harvey &lt;neilharvey@gmail.com&gt;</author>
  <creation-date>3 Nov 2005</creation-date>
  <model-version>3.0</model-version>

  <herd-file>6herds_2</herd-file>

  <parameter-file>cattle_trigger_pigs_vacc</parameter-file>

  <parameter-description>
    For all production types, the latent period lasts 1 day, infectiousness
    lasts 3 days, clinical signs accompany infectiousness immediately, and
    natural immunity lasts 3 days.

    There is no spread.
    
    The probability of detecting diseased units vs. the number of days they
    have been showing clinical signs is fixed at 1. The probability of
    detecting diseased units vs. the number of days since a public announcement
    of an outbreak is also fixed at 1.

    The authorities will destroy units that are detected as diseased.  The
    authorities can begin a destruction program immediately.  The authorities
    can destroy an unlimited/very large number of units each day.  The
    authorities will vaccinate pigs within 1.5 km of a detected cattle unit.
    The vaccine produces immunity immediately, and the immunity lasts 5 days.
    The authorities will not re-vaccinate a unit for 31 days after a
    vaccination.

    Recapping what should happen as a result of all this:
    &lt;ul&gt;
      &lt;li&gt; On day 1 units 0 (cattle) and 1 (pigs) will be latent.
      &lt;li&gt; On day 2 units 0 and 1 will be Infectious Clinical.  They will
        be detected and marked for destruction.  Unit 3 will be marked for
        vaccination because it is a pig unit within 1.5 km of a detected cattle
        unit.
      &lt;li&gt; On day 3 units 0 and 1 will be destroyed, and unit 3 will be
        vaccinated.
      &lt;li&gt; On day 4 unit 3 will be immune.
    &lt;/ul&gt;  
  </parameter-description>

  <output>
    <tr><td>Latent</td>              <td>Latent</td>              <td>Susceptible</td>  <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>InfectiousClinical</td>  <td>Susceptible</td>  <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>InfectiousClinical</td>  <td>Susceptible</td>  <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td></tr>
    <tr><td>Destroyed</td>           <td>Destroyed</td>           <td>Susceptible</td>  <td>VaccineImmune</td>  <td>Susceptible</td>  <td>Susceptible</td></tr>
  </output>
</deterministic-test>

<deterministic-test>
  <category>ring-vaccination</category>
  <short-name>cattle trigger, both vaccinated</short-name>

  <description>
    Test that production types that trigger vaccination rings and production
    types that are vaccinated can be specified independently.  In this
    scenario, only cattle units detected as diseased trigger vaccination rings,
    but both cattle and pig units in the rings are vaccinated.
  </description>

  <author>Neil Harvey &lt;neilharvey@gmail.com&gt;</author>
  <creation-date>3 Nov 2005</creation-date>
  <model-version>3.0</model-version>

  <herd-file>6herds_2</herd-file>

  <parameter-file>cattle_trigger_both_vacc</parameter-file>

  <parameter-description>
    For all production types, the latent period lasts 1 day, infectiousness
    lasts 3 days, clinical signs accompany infectiousness immediately, and
    natural immunity lasts 3 days.

    There is no spread.
    
    The probability of detecting diseased units vs. the number of days they
    have been showing clinical signs is fixed at 1. The probability of
    detecting diseased units vs. the number of days since a public announcement
    of an outbreak is also fixed at 1.

    The authorities will destroy units that are detected as diseased.  The
    authorities can begin a destruction program immediately.  The authorities
    can destroy an unlimited/very large number of units each day.  The
    authorities will vaccinate cattle and pigs within 1.5 km of a detected
    cattle unit.  The vaccine produces immunity immediately, and the immunity
    lasts 5 days.  The authorities will not re-vaccinate a unit for 31 days
    after a vaccination.

    Recapping what should happen as a result of all this:
    &lt;ul&gt;
      &lt;li&gt; On day 1 units 0 (cattle) and 1 (pigs) will be latent.
      &lt;li&gt; On day 2 units 0 and 1 will be Infectious Clinical.  They will
        be detected and marked for destruction.  Units 2 and 3 will be marked
        for vaccination because they are cattle and pig units, respectively,
        within 1.5 km of a detected cattle unit.
      &lt;li&gt; On day 3 units 0 and 1 will be destroyed, and units 2 and 3
        will be vaccinated.
      &lt;li&gt; On day 4 units 2 and 3 will be immune.
    &lt;/ul&gt;  
  </parameter-description>

  <output>
    <tr><td>Latent</td>              <td>Latent</td>              <td>Susceptible</td>    <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>InfectiousClinical</td>  <td>Susceptible</td>    <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>InfectiousClinical</td>  <td>Susceptible</td>    <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td></tr>
    <tr><td>Destroyed</td>           <td>Destroyed</td>           <td>VaccineImmune</td>  <td>VaccineImmune</td>  <td>Susceptible</td>  <td>Susceptible</td></tr>
  </output>
</deterministic-test>

<deterministic-test>
  <category>ring-vaccination</category>
  <short-name>pigs trigger, cattle vaccinated</short-name>

  <description>
    Test that production types that trigger vaccination rings and production
    types that are vaccinated can be specified independently.  In this
    scenario, only pig units detected as diseased trigger vaccination rings,
    and only cattle units in the rings are vaccinated.
  </description>

  <author>Neil Harvey &lt;neilharvey@gmail.com&gt;</author>
  <creation-date>3 Nov 2005</creation-date>
  <model-version>3.0</model-version>

  <herd-file>6herds_2</herd-file>

  <parameter-file>pigs_trigger_cattle_vacc</parameter-file>

  <parameter-description>
    For all production types, the latent period lasts 1 day, infectiousness
    lasts 3 days, clinical signs accompany infectiousness immediately, and
    natural immunity lasts 3 days.

    There is no spread.
    
    The probability of detecting diseased units vs. the number of days they
    have been showing clinical signs is fixed at 1. The probability of
    detecting diseased units vs. the number of days since a public announcement
    of an outbreak is also fixed at 1.

    The authorities will destroy units that are detected as diseased.  The
    authorities can begin a destruction program immediately.  The authorities
    can destroy an unlimited/very large number of units each day.  The
    authorities will vaccinate cattle within 1.5 km of a detected pig unit.
    The vaccine produces immunity immediately, and the immunity lasts 5 days.
    The authorities will not re-vaccinate a unit for 31 days after a
    vaccination.

    Recapping what should happen as a result of all this:
    &lt;ul&gt;
      &lt;li&gt; On day 1 units 0 (cattle) and 1 (pigs) will be latent.
      &lt;li&gt; On day 2 units 0 and 1 will be Infectious Clinical.  They will
        be detected and marked for destruction.  Unit 4 will be marked for
        vaccination because it is a cattle unit within 1.5 km of a detected
        pig unit.
      &lt;li&gt; On day 3 units 0 and 1 will be destroyed, and unit 4 will be
        vaccinated.
      &lt;li&gt; On day 4 unit 4 will be immune.
    &lt;/ul&gt;  
  </parameter-description>

  <output>
    <tr><td>Latent</td>              <td>Latent</td>              <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>    <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>InfectiousClinical</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>    <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>InfectiousClinical</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>    <td>Susceptible</td></tr>
    <tr><td>Destroyed</td>           <td>Destroyed</td>           <td>Susceptible</td>  <td>Susceptible</td>  <td>VaccineImmune</td>  <td>Susceptible</td></tr>
  </output>
</deterministic-test>

<deterministic-test>
  <category>ring-vaccination</category>
  <short-name>pigs trigger, pigs vaccinated</short-name>

  <description>
    Test that production types that trigger vaccination rings and production
    types that are vaccinated can be specified independently.  In this
    scenario, only pig units detected as diseased trigger vaccination rings,
    and only pig units in the rings are vaccinated.
  </description>

  <author>Neil Harvey &lt;neilharvey@gmail.com&gt;</author>
  <creation-date>3 Nov 2005</creation-date>
  <model-version>3.0</model-version>

  <herd-file>6herds_2</herd-file>

  <parameter-file>pigs_trigger_pigs_vacc</parameter-file>

  <parameter-description>
    For all production types, the latent period lasts 1 day, infectiousness
    lasts 3 days, clinical signs accompany infectiousness immediately, and
    natural immunity lasts 3 days.

    There is no spread.
    
    The probability of detecting diseased units vs. the number of days they
    have been showing clinical signs is fixed at 1. The probability of
    detecting diseased units vs. the number of days since a public announcement
    of an outbreak is also fixed at 1.

    The authorities will destroy units that are detected as diseased.  The
    authorities can begin a destruction program immediately.  The authorities
    can destroy an unlimited/very large number of units each day.  The
    authorities will vaccinate pigs within 1.5 km of a detected pig unit.  The
    vaccine produces immunity immediately, and the immunity lasts 5 days.  The
    authorities will not re-vaccinate a unit for 31 days after a vaccination.

    Recapping what should happen as a result of all this:
    &lt;ul&gt;
      &lt;li&gt; On day 1 units 0 (cattle) and 1 (pigs) will be latent.
      &lt;li&gt; On day 2 units 0 and 1 will be Infectious Clinical.  They will
        be detected and marked for destruction.  Unit 5 will be marked for
        vaccination because it is a pig unit within 1.5 km of a detected pig
        unit.
      &lt;li&gt; On day 3 units 0 and 1 will be destroyed, and unit 5 will be
        vaccinated.
      &lt;li&gt; On day 4 unit 5 will be immune.
    &lt;/ul&gt;  
  </parameter-description>

  <output>
    <tr><td>Latent</td>              <td>Latent</td>              <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>InfectiousClinical</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>InfectiousClinical</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td></tr>
    <tr><td>Destroyed</td>           <td>Destroyed</td>           <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>VaccineImmune</td></tr>
  </output>
</deterministic-test>

<deterministic-test>
  <category>ring-vaccination</category>
  <short-name>pigs trigger, both vaccinated</short-name>

  <description>
    Test that production types that trigger vaccination rings and production
    types that are vaccinated can be specified independently.  In this
    scenario, only pig units detected as diseased trigger vaccination rings,
    but both cattle and pig units in the rings are vaccinated.
  </description>

  <author>Neil Harvey &lt;neilharvey@gmail.com&gt;</author>
  <creation-date>3 Nov 2005</creation-date>
  <model-version>3.0</model-version>

  <herd-file>6herds_2</herd-file>

  <parameter-file>pigs_trigger_both_vacc</parameter-file>

  <parameter-description>
    For all production types, the latent period lasts 1 day, infectiousness
    lasts 3 days, clinical signs accompany infectiousness immediately, and
    natural immunity lasts 3 days.

    There is no spread.
    
    The probability of detecting diseased units vs. the number of days they
    have been showing clinical signs is fixed at 1. The probability of
    detecting diseased units vs. the number of days since a public announcement
    of an outbreak is also fixed at 1.

    The authorities will destroy units that are detected as diseased.  The
    authorities can begin a destruction program immediately.  The authorities
    can destroy an unlimited/very large number of units each day.  The
    authorities will vaccinate cattle and pigs within 1.5 km of a detected pig
    unit.  The vaccine produces immunity immediately, and the immunity lasts 5
    5 days.  The authorities will not re-vaccinate a unit for 31 days after a
    vaccination.

    Recapping what should happen as a result of all this:
    &lt;ul&gt;
      &lt;li&gt; On day 1 units 0 (cattle) and 1 (pigs) will be latent.
      &lt;li&gt; On day 2 units 0 and 1 will be Infectious Clinical.  They will
        be detected and marked for destruction.  Units 4 and 5 will be marked
        for vaccination because they are cattle and pig units, respectively,
        within 1.5 km of a detected pig unit.
      &lt;li&gt; On day 3 units 0 and 1 will be destroyed, and units 4 and 5
        will be vaccinated.
      &lt;li&gt; On day 4 units 4 and 5 will be immune.
    &lt;/ul&gt;  
  </parameter-description>

  <output>
    <tr><td>Latent</td>              <td>Latent</td>              <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>    <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>InfectiousClinical</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>    <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>InfectiousClinical</td>  <td>Susceptible</td>  <td>Susceptible</td>  <td>Susceptible</td>    <td>Susceptible</td></tr>
    <tr><td>Destroyed</td>           <td>Destroyed</td>           <td>Susceptible</td>  <td>Susceptible</td>  <td>VaccineImmune</td>  <td>VaccineImmune</td></tr>
  </output>
</deterministic-test>

<deterministic-test>
  <category>ring-vaccination</category>
  <short-name>both trigger, cattle vaccinated</short-name>

  <description>
    Test that production types that trigger vaccination rings and production
    types that are vaccinated can be specified independently.  In this
    scenario, cattle and pig units detected as diseased trigger vaccination
    rings, but only cattle units in the rings are vaccinated.
  </description>

  <author>Neil Harvey &lt;neilharvey@gmail.com&gt;</author>
  <creation-date>3 Nov 2005</creation-date>
  <model-version>3.0</model-version>

  <herd-file>6herds_2</herd-file>

  <parameter-file>both_trigger_cattle_vacc</parameter-file>

  <parameter-description>
    For all production types, the latent period lasts 1 day, infectiousness
    lasts 3 days, clinical signs accompany infectiousness immediately, and
    natural immunity lasts 3 days.

    There is no spread.
    
    The probability of detecting diseased units vs. the number of days they
    have been showing clinical signs is fixed at 1. The probability of
    detecting diseased units vs. the number of days since a public announcement
    of an outbreak is also fixed at 1.

    The authorities will destroy units that are detected as diseased.  The
    authorities can begin a destruction program immediately.  The authorities
    can destroy an unlimited/very large number of units each day.  The
    authorities will vaccinate cattle within 1.5 km of a detected cattle or pig
    unit.  The vaccine produces immunity immediately, and the immunity lasts 5
    days.  The authorities will not re-vaccinate a unit for 31 days after a
    vaccination.

    Recapping what should happen as a result of all this:
    &lt;ul&gt;
      &lt;li&gt; On day 1 units 0 (cattle) and 1 (pigs) will be latent.
      &lt;li&gt; On day 2 units 0 and 1 will be Infectious Clinical.  They will
        be detected and marked for destruction.  Units 2 and 4 will be marked
        for vaccination because they are cattle units within 1.5 km of a
        detected cattle and pig unit, respectively.
      &lt;li&gt; On day 3 units 0 and 1 will be destroyed, and units 2 and 4
        will be vaccinated.
      &lt;li&gt; On day 4 units 2 and 4 will be immune.
    &lt;/ul&gt;  
  </parameter-description>

  <output>
    <tr><td>Latent</td>              <td>Latent</td>              <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td>    <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>InfectiousClinical</td>  <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td>    <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>InfectiousClinical</td>  <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td>    <td>Susceptible</td></tr>
    <tr><td>Destroyed</td>           <td>Destroyed</td>           <td>VaccineImmune</td>  <td>Susceptible</td>  <td>VaccineImmune</td>  <td>Susceptible</td></tr>
  </output>
</deterministic-test>

<deterministic-test>
  <category>ring-vaccination</category>
  <short-name>both trigger, pigs vaccinated</short-name>

  <description>
    Test that production types that trigger vaccination rings and production
    types that are vaccinated can be specified independently.  In this
    scenario, cattle and pig units detected as diseased trigger vaccination
    rings, but only pig units in the rings are vaccinated.
  </description>

  <author>Neil Harvey &lt;neilharvey@gmail.com&gt;</author>
  <creation-date>3 Nov 2005</creation-date>
  <model-version>3.0</model-version>

  <herd-file>6herds_2</herd-file>

  <parameter-file>both_trigger_pigs_vacc</parameter-file>

  <parameter-description>
    For all production types, the latent period lasts 1 day, infectiousness
    lasts 3 days, clinical signs accompany infectiousness immediately, and
    natural immunity lasts 3 days.

    There is no spread.
    
    The probability of detecting diseased units vs. the number of days they
    have been showing clinical signs is fixed at 1. The probability of
    detecting diseased units vs. the number of days since a public announcement
    of an outbreak is also fixed at 1.

    The authorities will destroy units that are detected as diseased.  The
    authorities can begin a destruction program immediately.  The authorities
    can destroy an unlimited/very large number of units each day.  The
    authorities will vaccinate pigs within 1.5 km of a detected cattle or pig
    unit.  The vaccine produces immunity immediately, and the immunity lasts 5
    days.  The authorities will not re-vaccinate a unit for 31 days after a
    vaccination.

    Recapping what should happen as a result of all this:
    &lt;ul&gt;
      &lt;li&gt; On day 1 units 0 (cattle) and 1 (pigs) will be latent.
      &lt;li&gt; On day 2 units 0 and 1 will be Infectious Clinical.  They will
        be detected and marked for destruction.  Units 3 and 5 will be marked
        for vaccination because they are pig units within 1.5 km of a detected
        cattle and pig unit, respectively.
      &lt;li&gt; On day 3 units 0 and 1 will be destroyed, and units 3 and 5
        will be vaccinated.
      &lt;li&gt; On day 4 units 3 and 5 will be immune.
    &lt;/ul&gt;  
  </parameter-description>

  <output>
    <tr><td>Latent</td>              <td>Latent</td>              <td>Susceptible</td>  <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>InfectiousClinical</td>  <td>Susceptible</td>  <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>InfectiousClinical</td>  <td>Susceptible</td>  <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td></tr>
    <tr><td>Destroyed</td>           <td>Destroyed</td>           <td>Susceptible</td>  <td>VaccineImmune</td>  <td>Susceptible</td>  <td>VaccineImmune</td></tr>
  </output>
</deterministic-test>

<deterministic-test>
  <category>ring-vaccination</category>
  <short-name>both trigger, both vaccinated</short-name>

  <description>
    Test that production types that trigger vaccination rings and production
    types that are vaccinated can be specified independently.  In this
    scenario, cattle and pig units detected as diseased trigger vaccination
    rings, and both cattle and pig units in the rings are vaccinated.
  </description>

  <author>Neil Harvey &lt;neilharvey@gmail.com&gt;</author>
  <creation-date>3 Nov 2005</creation-date>
  <model-version>3.0</model-version>

  <herd-file>6herds_2</herd-file>

  <parameter-file>both_trigger_both_vacc</parameter-file>

  <parameter-description>
    For all production types, the latent period lasts 1 day, infectiousness
    lasts 3 days, clinical signs accompany infectiousness immediately, and
    natural immunity lasts 3 days.

    There is no spread.
    
    The probability of detecting diseased units vs. the number of days they
    have been showing clinical signs is fixed at 1. The probability of
    detecting diseased units vs. the number of days since a public announcement
    of an outbreak is also fixed at 1.

    The authorities will destroy units that are detected as diseased.  The
    authorities can begin a destruction program immediately.  The authorities
    can destroy an unlimited/very large number of units each day.  The
    authorities will vaccinate cattle and pigs within 1.5 km of a detected
    cattle or pig unit.  The vaccine produces immunity immediately, and the
    immunity lasts 5 days.  The authorities will not re-vaccinate a unit for 31
    days after a vaccination.

    Recapping what should happen as a result of all this:
    &lt;ul&gt;
      &lt;li&gt; On day 1 units 0 (cattle) and 1 (pigs) will be latent.
      &lt;li&gt; On day 2 units 0 and 1 will be Infectious Clinical.  They will
        be detected and marked for destruction.  Units 2, 3, 4 and 5 will be
        marked for vaccination because they are a cattle unit within 1.5 km of
        a detected cattle unit (2), a pig unit within 1.5 km of a detected
        cattle unit (3), a cattle unit within 1.5 km of a detected pig unit
        (4), and a pig unit within 1.5 km of a detected pig unit (5).
      &lt;li&gt; On day 3 units 0 and 1 will be destroyed, and units 2, 3, 4
        and 5 will be vaccinated.
      &lt;li&gt; On day 4 units 2, 3, 4 and 5 will be immune.
    &lt;/ul&gt;  
  </parameter-description>

  <output>
    <tr><td>Latent</td>              <td>Latent</td>              <td>Susceptible</td>    <td>Susceptible</td>    <td>Susceptible</td>    <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>InfectiousClinical</td>  <td>Susceptible</td>    <td>Susceptible</td>    <td>Susceptible</td>    <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>InfectiousClinical</td>  <td>Susceptible</td>    <td>Susceptible</td>    <td>Susceptible</td>    <td>Susceptible</td></tr>
    <tr><td>Destroyed</td>           <td>Destroyed</td>           <td>VaccineImmune</td>  <td>VaccineImmune</td>  <td>VaccineImmune</td>  <td>VaccineImmune</td></tr>
  </output>
</deterministic-test>

<deterministic-test>
  <category>ring-vaccination</category>
  <short-name>size vaccination rings by production type 1</short-name>

  <description>
    Test that the radius of a vaccination ring can be set by the production
    type that triggered the ring.  In this scenario, detection of a diseased
    cattle unit triggers a small vaccination ring.
  </description>

  <author>Neil Harvey &lt;neilharvey@gmail.com&gt;</author>
  <creation-date>4 Nov 2005</creation-date>
  <model-version>3.0</model-version>

  <herd-file>6herds_2</herd-file>

  <parameter-file>trigger_small_ring</parameter-file>

  <parameter-description>
    For all production types, the latent period lasts 1 day, infectiousness
    lasts 3 days, clinical signs accompany infectiousness immediately, and
    natural immunity lasts 3 days.

    There is no spread.
    
    The probability of detecting diseased cattle units vs. the number of days
    they have been showing clinical signs is fixed at 1. The probability of
    detecting diseased cattle units vs. the number of days since a public
    announcement of an outbreak is also fixed at 1.  The probability of
    detecting diseased pig units is 0.

    The authorities will destroy units that are detected as diseased.  The
    authorities can begin a destruction program immediately.  The authorities
    can destroy an unlimited/very large number of units each day.  The
    authorities will vaccinate cattle and pigs within 1.5 km of a detected
    cattle unit, or within 2.5 km of a detected pig unit.  The authorities can
    vaccinate 1 unit per day.  Cattle have priority over pigs.
    
    The vaccine produces immunity immediately, and the immunity lasts 5 days.
    The authorities will not re-vaccinate a unit for 31 days after a
    vaccination.

    Recapping what should happen as a result of all this:
    &lt;ul&gt;
      &lt;li&gt; On day 1 units 0 (cattle) and 1 (pigs) will be latent.
      &lt;li&gt; On day 2 units 0 and 1 will be Infectious Clinical.  Unit 0
        (cattle) will be detected and marked for destruction.  Units 2 and 3
        will be marked for vaccination because they are within 1.5 km of a
        detected cattle unit.
      &lt;li&gt; On day 3 unit 0 will be destroyed.  Unit 2 will be vaccinated
        because it is cattle.
      &lt;li&gt; On day 4 unit 2 will be immune.  Unit 3 will be vaccinated.
      &lt;li&gt; On day 5 unit 3 will be immune.
    &lt;/ul&gt;  
  </parameter-description>

  <output>
    <tr><td>Latent</td>              <td>Latent</td>              <td>Susceptible</td>    <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>InfectiousClinical</td>  <td>Susceptible</td>    <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>InfectiousClinical</td>  <td>Susceptible</td>    <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td></tr>
    <tr><td>Destroyed</td>           <td>InfectiousClinical</td>  <td>VaccineImmune</td>  <td>Susceptible</td>    <td>Susceptible</td>  <td>Susceptible</td></tr>
    <tr><td>Destroyed</td>           <td>NaturallyImmune</td>     <td>VaccineImmune</td>  <td>VaccineImmune</td>  <td>Susceptible</td>  <td>Susceptible</td></tr>
  </output>
</deterministic-test>

<deterministic-test>
  <category>ring-vaccination</category>
  <short-name>size vaccination rings by production type 2</short-name>

  <description>
    Test that the radius of a vaccination ring can be set by the production
    type that triggered the ring.  In this scenario, detection of a diseased
    pig unit triggers a large vaccination ring.
  </description>

  <author>Neil Harvey &lt;neilharvey@gmail.com&gt;</author>
  <creation-date>4 Nov 2005</creation-date>
  <model-version>3.0</model-version>

  <herd-file>6herds_2</herd-file>

  <parameter-file>trigger_large_ring</parameter-file>

  <parameter-description>
    For all production types, the latent period lasts 1 day, infectiousness
    lasts 3 days, clinical signs accompany infectiousness immediately, and
    natural immunity lasts 3 days.

    There is no spread.
    
    The probability of detecting diseased pig units vs. the number of days they
    have been showing clinical signs is fixed at 1. The probability of
    detecting diseased pig units vs. the number of days since a public
    announcement of an outbreak is also fixed at 1.  The probability of
    detecting diseased cattle units is 0.

    The authorities will destroy units that are detected as diseased.  The
    authorities can begin a destruction program immediately.  The authorities
    can destroy an unlimited/very large number of units each day.  The
    authorities will vaccinate cattle and pigs within 1.5 km of a detected
    cattle unit, or within 2.5 km of a detected pig unit.  The authorities can
    vaccinate 3 units per day.  Cattle have priority over pigs.

    The vaccine produces immunity immediately, and the immunity lasts 5 days.
    The authorities will not re-vaccinate a unit for 31 days after a
    vaccination.

    Recapping what should happen as a result of all this:
    &lt;ul&gt;
      &lt;li&gt; On day 1 units 0 (cattle) and 1 (pigs) will be latent.
      &lt;li&gt; On day 2 units 0 and 1 will be Infectious Clinical.  Unit 1
        (pigs) will be detected and marked for destruction.  Units 0, 2, 3, 4
        and 5 will be marked for vaccination because they are within 2.5 km of a
        detected pig unit.
      &lt;li&gt; On day 3 unit 1 will be destroyed.  Units 0, 2 and 4 will be
        vaccinated because they are cattle.
      &lt;li&gt; On day 4 units 2 and 4 will be immune.  Units 3 and 5 will be
        vaccinated.
      &lt;li&gt; On day 5 units 3 and 5 will be immune.
    &lt;/ul&gt;  
  </parameter-description>

  <output>
    <tr><td>Latent</td>              <td>Latent</td>              <td>Susceptible</td>    <td>Susceptible</td>    <td>Susceptible</td>    <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>InfectiousClinical</td>  <td>Susceptible</td>    <td>Susceptible</td>    <td>Susceptible</td>    <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>InfectiousClinical</td>  <td>Susceptible</td>    <td>Susceptible</td>    <td>Susceptible</td>    <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>Destroyed</td>           <td>VaccineImmune</td>  <td>Susceptible</td>    <td>VaccineImmune</td>  <td>Susceptible</td></tr>
    <tr><td>NaturallyImmune</td>     <td>Destroyed</td>           <td>VaccineImmune</td>  <td>VaccineImmune</td>  <td>VaccineImmune</td>  <td>VaccineImmune</td></tr>
  </output>
</deterministic-test>

<deterministic-test>
  <category>ring-vaccination</category>
  <short-name>no quarantine on waiting units 1</short-name>

  <description>
    Test that units that are marked for vaccination are not quarantined while
    waiting for the vaccination to happen.  This is different from destruction,
    in which units are quarantined while waiting for the destruction to happen.
    
    In this test and the following two, there are three units of different
    production types:

    0-&gt;1  2

    Units 0 and 2 are infected; the middle unit 1 is not.  The effects on unit
    1 can be observed when a) unit 1 is marked for vaccination, b) unit 0
    attempts to ship to unit 1, and c) both.

    In this scenario, unit 1 is not marked for vaccination, and unit 0 attempts
    to ship to unit 1.
  </description>

  <author>Neil Harvey &lt;neilharvey@gmail.com&gt;</author>
  <creation-date>26 Jan 2006</creation-date>
  <model-version>3.0</model-version>

  <herd-file>3herds_pigs_cattle_sheep_pigs_sheep_infected</herd-file>

  <parameter-file>quarantine_waiting_0</parameter-file>

  <parameter-description>
    For all production types, the latent period lasts 1 day, infectiousness
    lasts 3 days, clinical signs accompany infectiousness immediately, and
    natural immunity lasts 5 days.

    The mean movement rate from sheep units to cattle units is 0.694 per day,
    which will give 1 shipment each day when used with fixed "random" numbers
    of 0.5.  The distance of shipments is fixed at 10 km.  The movement rate
    multiplier is 0 until the public is aware of the outbreak, then it
    immediately goes to 1.  (This is the opposite of what one might expect from
    movement controls; its purpose here is to make sure any contact we see
    between cattle units happens after the creation of vaccination rings, not
    before.)  There are no shipments between any other pairs of production
    types.

    Latent units can be the source of an exposure.
    
    The probability of infection given exposure is 1.
    
    The probability of detecting diseased pig units vs. the number of days they
    have been showing clinical signs is fixed at 1. The probability of
    detecting diseased pig units vs. the number of days since a public
    announcement of an outbreak is also fixed at 1.  Other production types are
    not detected.

    The authorities will destroy units that are detected as diseased.  The
    authorities can begin a destruction program immediately.  The authorities
    can destroy 1 unit per day.

    A vaccination program begins at the first detection.  The authorities will
    vaccinate units within 5 km of a detected pig unit.  On the first day that
    vaccinations could occur, the vaccination capacity will be zero.  The next
    day and forward, the vaccination capacity is 1 unit per day.  The vaccine
    produces immunity immediately, and the immunity lasts 5 days.

    Recapping what should happen as a result of all this:
     - On day 1 units 0 (sheep) and 2 (pigs) will be latent.  There will be no
       shipments because the movement rate multiplier is 0.
     - On day 2 units 0 and 2 will be Infectious Clinical.  Unit 2 (pigs) will
       be detected and marked for destruction.  The 5 km radius vaccination
       ring drawn around unit 2 will not be large enough to cover unit 1.
     - On day 3 (1 day after the first detection) the movement rate multiplier
       will be 1.  Unit 0 (sheep) will ship to and infect unit 1 (cattle).
       Unit 2 will be destroyed.
     - On day 4 unit 1 will be Latent.
  </parameter-description>

  <output>
    <tr><td>Latent</td>              <td>Susceptible</td>         <td>Latent</td></tr>
    <tr><td>InfectiousClinical</td>  <td>Susceptible</td>         <td>InfectiousClinical</td></tr>
    <tr><td>InfectiousClinical</td>  <td>Susceptible</td>         <td>InfectiousClinical</td></tr>
    <tr><td>InfectiousClinical</td>  <td>Latent</td>              <td>Destroyed</td></tr>
    <tr><td>NaturallyImmune</td>     <td>InfectiousClinical</td>  <td>Destroyed</td></tr>
    <tr><td>NaturallyImmune</td>     <td>InfectiousClinical</td>  <td>Destroyed</td></tr>
    <tr><td>NaturallyImmune</td>     <td>InfectiousClinical</td>  <td>Destroyed</td></tr>
    <tr><td>NaturallyImmune</td>     <td>NaturallyImmune</td>     <td>Destroyed</td></tr>
  </output>
</deterministic-test>

<deterministic-test>
  <category>ring-vaccination</category>
  <short-name>no quarantine on waiting units 2</short-name>

  <description>
    Test that units that are marked for vaccination are not quarantined while
    waiting for the vaccination to happen.  This is different from destruction,
    in which units are quarantined while waiting for the destruction to happen.
    
    In this test and the following two, there are three units of different
    production types:

    0-&gt;1  2

    Units 0 and 2 are infected; the middle unit 1 is not.  The effects on unit
    1 can be observed when a) unit 1 is marked for vaccination, b) unit 0
    attempts to ship to unit 1, and c) both.

    In this scenario, unit 1 is marked for vaccination, and unit 0 does not
    attempt to ship to unit 1.
  </description>

  <author>Neil Harvey &lt;neilharvey@gmail.com&gt;</author>
  <creation-date>26 Jan 2006</creation-date>
  <model-version>3.0</model-version>

  <herd-file>3herds_pigs_cattle_sheep_pigs_sheep_infected</herd-file>

  <parameter-file>quarantine_waiting_1</parameter-file>

  <parameter-description>
    For all production types, the latent period lasts 1 day, infectiousness
    lasts 3 days, clinical signs accompany infectiousness immediately, and
    natural immunity lasts 5 days.

    There are no shipments.
    
    The probability of detecting diseased pig units vs. the number of days they
    have been showing clinical signs is fixed at 1. The probability of
    detecting diseased pig units vs. the number of days since a public
    announcement of an outbreak is also fixed at 1.  Other production types are
    not detected.

    The authorities will destroy units that are detected as diseased.  The
    authorities can begin a destruction program immediately.  The authorities
    can destroy 1 unit per day.

    A vaccination program begins at the first detection.  The authorities will
    vaccinate cattle within 15 km of a detected pig unit.  On the first day of
    that vaccinations could occur, the vaccination capacity will be zero.  The
    next day and forward, the vaccination capacity is 1 unit per day.  The
    vaccine produces immunity immediately, and the immunity lasts 5 days.

    Recapping what should happen as a result of all this:
     - On day 1 units 0 (sheep) and 2 (pigs) will be latent.
     - On day 2 units 0 and 2 will be Infectious Clinical.  Unit 2 (pigs) will
       be detected and marked for destruction.  Unit 1 (cattle) will be marked
       for vaccination because it is within 15 km of a detected pig unit.
     - On day 3 unit 2 will be destroyed.  Unit 1 will not be vaccinated
       because the vaccination capacity is still 0.
     - On day 4 the vaccination capacity will be 1 and unit 1 will be
       vaccinated.
     - On day 5 unit 1 will be immune.
  </parameter-description>

  <output>
    <tr><td>Latent</td>              <td>Susceptible</td>         <td>Latent</td></tr>
    <tr><td>InfectiousClinical</td>  <td>Susceptible</td>         <td>InfectiousClinical</td></tr>
    <tr><td>InfectiousClinical</td>  <td>Susceptible</td>         <td>InfectiousClinical</td></tr>
    <tr><td>InfectiousClinical</td>  <td>Susceptible</td>         <td>Destroyed</td></tr>
    <tr><td>NaturallyImmune</td>     <td>VaccineImmune</td>       <td>Destroyed</td></tr>
    <!-- No infectious units, simulation stops. -->
  </output>
</deterministic-test>

<deterministic-test>
  <category>ring-vaccination</category>
  <short-name>no quarantine on waiting units 3</short-name>

  <description>
    Test that units that are marked for vaccination are not quarantined while
    waiting for the vaccination to happen.  This is different from destruction,
    in which units are quarantined while waiting for the destruction to happen.
    
    In this test and the following two, there are three units of different
    production types:

    0-&gt;1  2

    Units 0 and 2 are infected; the middle unit 1 is not.  The effects on unit
    1 can be observed when a) unit 1 is marked for vaccination, b) unit 0
    attempts to ship to unit 1, and c) both.

    In this scenario, unit 1 is marked for vaccination and unit 0 attempts to
    ship to unit 1.
  </description>

  <author>Neil Harvey &lt;neilharvey@gmail.com&gt;</author>
  <creation-date>26 Jan 2006</creation-date>
  <model-version>3.0</model-version>

  <herd-file>3herds_pigs_cattle_sheep_pigs_sheep_infected</herd-file>

  <parameter-file>quarantine_waiting_2</parameter-file>

  <parameter-description>
    For all production types, the latent period lasts 1 day, infectiousness
    lasts 3 days, clinical signs accompany infectiousness immediately, and
    natural immunity lasts 5 days.

    The mean movement rate from sheep units to cattle units is 0.694 per day,
    which will give 1 shipment each day when used with fixed "random" numbers
    of 0.5.  The distance of shipments is fixed at 10 km.  The movement rate
    multiplier is 0 until the public is aware of the outbreak, then it
    immediately goes to 1.  (This is the opposite of what one might expect from
    movement controls; its purpose here is to make sure any contact we see
    between cattle units happens after the creation of vaccination rings, not
    before.)  There are no shipments between any other pairs of production
    types.

    Latent units can be the source of an exposure.
    
    The probability of infection given exposure is 1.
    
    The probability of detecting diseased pig units vs. the number of days they
    have been showing clinical signs is fixed at 1. The probability of
    detecting diseased pig units vs. the number of days since a public
    announcement of an outbreak is also fixed at 1.  Other production types are
    not detected.

    The authorities will destroy units that are detected as diseased.  The
    authorities can begin a destruction program immediately.  The authorities
    can destroy 1 unit per day.

    A vaccination program begins at the second detection.  The authorities will
    vaccinate cattle within 15 km of a detected pig unit.  On the first day of
    that vaccinations could occur, the vaccination capacity will be zero.  The
    next day and forward, the vaccination capacity is 1 unit per day.  The
    vaccine produces immunity immediately, and the immunity lasts 5 days.

    Recapping what should happen as a result of all this:
     - On day 1 units 0 (sheep) and 2 (pigs) will be latent.  There will be no
       shipments because the movement rate multiplier is 0.
     - On day 2 units 0 and 2 will be Infectious Clinical.  Unit 2 (pigs) will
       be detected and marked for destruction.  Unit 1 (cattle) will be marked
       for vaccination because it is within 15 km of a detected pig unit.
     - On day 3 (1 day after the first detection) the movement rate multiplier
       will be 1.  Unit 0 (sheep) will ship to and infect unit 1 (cattle).
       Unit 2 will be destroyed.
     - On day 4 unit 1 will be Latent.
  </parameter-description>

  <output>
    <tr><td>Latent</td>              <td>Susceptible</td>         <td>Latent</td></tr>
    <tr><td>InfectiousClinical</td>  <td>Susceptible</td>         <td>InfectiousClinical</td></tr>
    <tr><td>InfectiousClinical</td>  <td>Susceptible</td>         <td>InfectiousClinical</td></tr>
    <tr><td>InfectiousClinical</td>  <td>Latent</td>              <td>Destroyed</td></tr>
    <tr><td>NaturallyImmune</td>     <td>InfectiousClinical</td>  <td>Destroyed</td></tr>
    <tr><td>NaturallyImmune</td>     <td>InfectiousClinical</td>  <td>Destroyed</td></tr>
    <tr><td>NaturallyImmune</td>     <td>InfectiousClinical</td>  <td>Destroyed</td></tr>
    <tr><td>NaturallyImmune</td>     <td>NaturallyImmune</td>     <td>Destroyed</td></tr>
  </output>
</deterministic-test>

<deterministic-test>
  <category>ring-vaccination</category>
  <short-name>early exit 1</short-name>

  <description>
    Test that the simulation's early-exit rules are followed with respect to
    units waiting for vaccination.
    
    In the tests "early exit" 1-3, there are two units.  Unit 0 is infected.
    On day 1 unit 0 is detected and unit 1 is marked for vaccination.
    Different effects can be observed when a) there are resources to vaccinate
    unit 1 immediately, b) there are no resources to vaccinate unit 1 at first,
    but resources eventually come on-line, or c) there are never resources to
    vaccinate unit 1.

    In this scenario, there are resources to vaccinate unit 1 immediately.
  </description>

  <author>Neil Harvey &lt;neilharvey@gmail.com&gt;</author>
  <creation-date>21 Feb 2006</creation-date>
  <model-version>3.0</model-version>

  <herd-file>2herds</herd-file>

  <parameter-file>early_exit_1</parameter-file>

  <parameter-description>
    The latent period lasts 1 day, infectiousness lasts 3 days, clinical signs
    accompany infectiousness immediately, and natural immunity lasts 3 days.

    There is no spread.
    
    The probability of detecting a diseased unit vs. the number of days the
    animals have been showing clinical signs is fixed at 1. The probability of
    detecting a diseased unit vs. the number of days since a public
    announcement of an outbreak is also fixed at 1.

    A vaccination program begins at the first detection.  The authorities will
    vaccinate units within 10 km of a detected unit.  The authorities can
    vaccinate an unlimited/very large number of units each day.  The vaccine
    produces immunity immediately, and the immunity lasts 5 days.

    There is no destruction.

    Recapping what should happen as a result of all this:
     - On day 1 unit 0 will be latent.
     - On day 2 unit 0 will be Infectious Clinical.  It will be detected, and
       unit 1 will be marked for vaccination because it is within 10 km of a
       detected unit.
     - On day 3 unit 1 will be vaccinated.
     - On day 4 unit 1's state will show as Immune.
     - On day 5 unit 0 will no longer be infectious.  Because there are no
       infectious units left and nothing left to do, the simulation can end.
  </parameter-description>

  <output>
    <tr><td>Latent</td>              <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>VaccineImmune</td></tr>
    <tr><td>NaturallyImmune</td>     <td>VaccineImmune</td></tr>
    <!-- No infectious units, simulation stops. -->
  </output>
</deterministic-test>

<variable-test>
  <category>ring-vaccination</category>
  <short-name>early exit 1, check reporting variables</short-name>

  <description>
    Test that the number of units and number of animals awaiting vaccination
    are reported correctly.  This scenario is identical to "early exit 1"
    above.
  </description>

  <author>Neil Harvey &lt;neilharvey@gmail.com&gt;</author>
  <creation-date>2 Oct 2006</creation-date>
  <model-version>3.0</model-version>

  <herd-file>2herds</herd-file>

  <parameter-file>early_exit_1_w_vars</parameter-file>

  <parameter-description>
    The latent period lasts 1 day, infectiousness lasts 3 days, clinical signs
    accompany infectiousness immediately, and natural immunity lasts 3 days.

    There is no spread.
    
    The probability of detecting a diseased unit vs. the number of days the
    animals have been showing clinical signs is fixed at 1. The probability of
    detecting a diseased unit vs. the number of days since a public
    announcement of an outbreak is also fixed at 1.

    A vaccination program begins at the first detection.  The authorities will
    vaccinate units within 10 km of a detected unit.  The authorities can
    vaccinate an unlimited/very large number of units each day.  The vaccine
    produces immunity immediately, and the immunity lasts 5 days.

    There is no destruction.

    Recapping what should happen as a result of all this:
     - On day 1 unit 0 will be latent.
     - On day 2 unit 0 will be Infectious Clinical.  It will be detected, and
       unit 1 will be marked for vaccination because it is within 10 km of a
       detected unit.
     - On day 3 unit 1 will be vaccinated.
     - On day 4 unit 1's state will show as Immune.
     - On day 5 unit 0 will no longer be infectious.  Because there are no
       infectious units left and nothing left to do, the simulation can end.
  </parameter-description>

  <output>
    <tr>
      <td>num-units-awaiting-vaccination</td>
      <td>num-animals-awaiting-vaccination</td>
      <td>num-units-vaccinated</td>
      <td>num-animals-vaccinated</td>
      <td>peak-num-units-awaiting-vaccination</td>
      <td>peak-num-animals-awaiting-vaccination</td>
      <td>peak-vaccination-wait-time</td>
      <td>average-vaccination-wait-time</td>
    </tr>
    <tr><td>0</td>   <td>0</td> <td>0</td>  <td>0</td>  <td>0</td>   <td>0</td>  <td>0</td>  <td>0</td></tr>
    <tr><td>1</td>  <td>25</td> <td>0</td>  <td>0</td>  <td>1</td>  <td>25</td>  <td>0</td>  <td>0</td></tr>
    <tr><td>0</td>   <td>0</td> <td>1</td> <td>25</td>  <td>1</td>  <td>25</td>  <td>1</td>  <td>1</td></tr>
    <tr><td>0</td>   <td>0</td> <td>0</td>  <td>0</td>  <td>1</td>  <td>25</td>  <td>1</td>  <td>1</td></tr>
    <tr><td>0</td>   <td>0</td> <td>0</td>  <td>0</td>  <td>1</td>  <td>25</td>  <td>1</td>  <td>1</td></tr>
    <!-- No infectious units, simulation stops. -->
  </output>
</variable-test>

<deterministic-test>
  <category>ring-vaccination</category>
  <short-name>early exit 2</short-name>

  <description>
    Test that the simulation's early-exit rules are followed with respect to
    units waiting for vaccination.
    
    In the tests "early exit" 1-3, there are two units.  Unit 0 is infected.
    On day 1 unit 0 is detected and unit 1 is marked for vaccination.
    Different effects can be observed when a) there are resources to vaccinate
    unit 1 immediately, b) there are no resources to vaccinate unit 1 at first,
    but resources eventually come on-line, or c) there are never resources to
    vaccinate unit 1.

    In this scenario, there are no resources to vaccinate unit 1 at first, but
    resources eventually come on-line.
  </description>

  <author>Neil Harvey &lt;neilharvey@gmail.com&gt;</author>
  <creation-date>21 Feb 2006</creation-date>
  <model-version>3.0</model-version>

  <herd-file>2herds</herd-file>

  <parameter-file>early_exit_2</parameter-file>

  <parameter-description>
    The latent period lasts 1 day, infectiousness lasts 3 days, clinical signs
    accompany infectiousness immediately, and natural immunity lasts 3 days.

    There is no spread.
    
    The probability of detecting a diseased unit vs. the number of days the
    animals have been showing clinical signs is fixed at 1. The probability of
    detecting a diseased unit vs. the number of days since a public
    announcement of an outbreak is also fixed at 1.

    A vaccination program begins at the first detection.  The authorities will
    vaccinate units within 10 km of a detected unit.  On the first 4 days that
    vaccinations could occur, the vaccination capacity will be zero.  The next
    day and forward, the vaccination capacity is 1 unit per day.  The vaccine
    produces immunity immediately, and the immunity lasts 5 days.

    There is no destruction.

    Recapping what should happen as a result of all this:
     - On day 1 unit 0 will be latent.
     - On day 2 unit 0 will be Infectious Clinical.  It will be detected, and
       unit 1 will be marked for vaccination because it is within 10 km of a
       detected unit.
     - Day 3 is the first day that vaccinations could happen, but there will be
       no vaccination capacity for 4 days.
     - On day 4 there will be no vaccination capacity for another 3 days.
     - On day 5 unit 0 will no longer be infectious.  However, the simulation
       will keep going because there are still vaccination tasks to be done.
       There will be no vaccination capacity for another 2 days.
     - On day 6 there will be no vaccination capacity for another 1 day.
     - On day 7 unit 1 will be vaccinated.
     - On day 8 unit 1's state will show as Immune.  Because there are no
       infectious units left and nothing left to do, the simulation can end.
  </parameter-description>

  <output>
    <tr><td>Latent</td>              <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>Susceptible</td></tr>
    <tr><td>NaturallyImmune</td>     <td>Susceptible</td></tr>
    <tr><td>NaturallyImmune</td>     <td>Susceptible</td></tr>
    <tr><td>NaturallyImmune</td>     <td>Susceptible</td></tr>
    <tr><td>Susceptible</td>         <td>VaccineImmune</td></tr>
    <!-- No infectious units, simulation stops. -->
  </output>
</deterministic-test>

<variable-test>
  <category>ring-vaccination</category>
  <short-name>early exit 2, check reporting variables</short-name>

  <description>
    Test that the number of units and number of animals awaiting vaccination
    are reported correctly.  This scenario is identical to "early exit 2"
    above.
  </description>

  <author>Neil Harvey &lt;neilharvey@gmail.com&gt;</author>
  <creation-date>2 Oct 2006</creation-date>
  <model-version>3.0</model-version>

  <herd-file>2herds</herd-file>

  <parameter-file>early_exit_2_w_vars</parameter-file>

  <parameter-description>
    The latent period lasts 1 day, infectiousness lasts 3 days, clinical signs
    accompany infectiousness immediately, and natural immunity lasts 3 days.

    There is no spread.
    
    The probability of detecting a diseased unit vs. the number of days the
    animals have been showing clinical signs is fixed at 1. The probability of
    detecting a diseased unit vs. the number of days since a public
    announcement of an outbreak is also fixed at 1.

    A vaccination program begins at the first detection.  The authorities will
    vaccinate units within 10 km of a detected unit.  On the first 4 days that
    vaccinations could occur, the vaccination capacity will be zero.  The next
    day and forward, the vaccination capacity is 1 unit per day.  The vaccine
    produces immunity immediately, and the immunity lasts 5 days.

    There is no destruction.

    Recapping what should happen as a result of all this:
     - On day 1 unit 0 will be latent.
     - On day 2 unit 0 will be Infectious Clinical.  It will be detected, and
       unit 1 will be marked for vaccination because it is within 10 km of a
       detected unit.
     - Day 3 is the first day that vaccinations could happen, but there will be
       no vaccination capacity for 4 days.
     - On day 4 there will be no vaccination capacity for another 3 days.
     - On day 5 unit 0 will no longer be infectious.  However, the simulation
       will keep going because there are still vaccination tasks to be done.
       There will be no vaccination capacity for another 2 days.
     - On day 6 there will be no vaccination capacity for another 1 day.
     - On day 7 unit 1 will be vaccinated.
     - On day 8 unit 1's state will show as Immune.  Because there are no
       infectious units left and nothing left to do, the simulation can end.
  </parameter-description>

  <output>
    <tr>
      <td>num-units-awaiting-vaccination</td>
      <td>num-animals-awaiting-vaccination</td>
      <td>num-units-vaccinated</td>
      <td>num-animals-vaccinated</td>
      <td>peak-num-units-awaiting-vaccination</td>
      <td>peak-num-animals-awaiting-vaccination</td>
      <td>peak-vaccination-wait-time</td>
      <td>average-vaccination-wait-time</td>
    </tr>
    <tr><td>0</td>   <td>0</td> <td>0</td>   <td>0</td>  <td>0</td>   <td>0</td>  <td>0</td>  <td>0</td></tr>
    <tr><td>1</td>  <td>25</td> <td>0</td>   <td>0</td>  <td>1</td>  <td>25</td>  <td>0</td>  <td>0</td></tr>
    <tr><td>1</td>  <td>25</td> <td>0</td>   <td>0</td>  <td>1</td>  <td>25</td>  <td>1</td>  <td>1</td></tr>
    <tr><td>1</td>  <td>25</td> <td>0</td>   <td>0</td>  <td>1</td>  <td>25</td>  <td>2</td>  <td>2</td></tr>
    <tr><td>1</td>  <td>25</td> <td>0</td>   <td>0</td>  <td>1</td>  <td>25</td>  <td>3</td>  <td>3</td></tr>
    <tr><td>1</td>  <td>25</td> <td>0</td>   <td>0</td>  <td>1</td>  <td>25</td>  <td>4</td>  <td>4</td></tr>
    <tr><td>0</td>   <td>0</td> <td>1</td>  <td>25</td>  <td>1</td>  <td>25</td>  <td>5</td>  <td>5</td></tr>
    <tr><td>0</td>   <td>0</td> <td>0</td>   <td>0</td>  <td>1</td>  <td>25</td>  <td>5</td>  <td>5</td></tr>
    <!-- No infectious units, simulation stops. -->
  </output>
</variable-test>

<deterministic-test>
  <category>ring-vaccination</category>
  <short-name>early exit 3</short-name>

  <description>
    Test that the simulation's early-exit rules are followed with respect to
    units waiting for vaccination.
    
    In the tests "early exit" 1-3, there are two units.  Unit 0 is infected.
    On day 1 unit 0 is detected and unit 1 is marked for vaccination.
    Different effects can be observed when a) there are resources to vaccinate
    unit 1 immediately, b) there are no resources to vaccinate unit 1 at first,
    but resources eventually come on-line, or c) there are never resources to
    vaccinate unit 1.

    In this scenario, there are never resources to vaccinate unit 1.
  </description>

  <author>Neil Harvey &lt;neilharvey@gmail.com&gt;</author>
  <creation-date>21 Feb 2006</creation-date>
  <model-version>3.0</model-version>

  <herd-file>2herds</herd-file>

  <parameter-file>early_exit_3</parameter-file>

  <parameter-description>
    The latent period lasts 1 day, infectiousness lasts 3 days, clinical signs
    accompany infectiousness immediately, and natural immunity lasts 3 days.

    There is no spread.
    
    The probability of detecting a diseased unit vs. the number of days the
    animals have been showing clinical signs is fixed at 1. The probability of
    detecting a diseased unit vs. the number of days since a public
    announcement of an outbreak is also fixed at 1.

    A vaccination program begins at the first detection.  The authorities will
    vaccinate units within 10 km of a detected unit.  The authorities can
    vaccinate zero units each day.  The vaccine produces immunity immediately,
    and the immunity lasts 5 days.

    There is no destruction.

    Recapping what should happen as a result of all this:
     - On day 1 unit 0 will be latent.
     - On day 2 unit 0 will be Infectious Clinical.  It will be detected, and
       unit 1 will be marked for vaccination because it is within 10 km of a
       detected unit.
     - On day 3 nothing new will happen.
     - On day 4 nothing new will happen.
     - On day 5 unit 0 will no longer be infectious.  Because there are no
       infectious units left and nothing left to do, the simulation can end.
  </parameter-description>

  <output>
    <tr><td>Latent</td>              <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>Susceptible</td></tr>
    <tr><td>NaturallyImmune</td>     <td>Susceptible</td></tr>
    <!-- No infectious units, simulation stops. -->
  </output>
</deterministic-test>

<variable-test>
  <category>ring-vaccination</category>
  <short-name>early exit 3, check reporting variables</short-name>

  <description>
    Test that the number of units and number of animals awaiting vaccination
    are reported correctly.  This scenario is identical to "early exit 3"
    above.
  </description>

  <author>Neil Harvey &lt;neilharvey@gmail.com&gt;</author>
  <creation-date>3 Oct 2006</creation-date>
  <model-version>3.0</model-version>

  <herd-file>2herds</herd-file>

  <parameter-file>early_exit_3_w_vars</parameter-file>

  <parameter-description>
    The latent period lasts 1 day, infectiousness lasts 3 days, clinical signs
    accompany infectiousness immediately, and natural immunity lasts 3 days.

    There is no spread.
    
    The probability of detecting a diseased unit vs. the number of days the
    animals have been showing clinical signs is fixed at 1. The probability of
    detecting a diseased unit vs. the number of days since a public
    announcement of an outbreak is also fixed at 1.

    A vaccination program begins at the first detection.  The authorities will
    vaccinate units within 10 km of a detected unit.  The authorities can
    vaccinate zero units each day.  The vaccine produces immunity immediately,
    and the immunity lasts 5 days.

    There is no destruction.

    Recapping what should happen as a result of all this:
     - On day 1 unit 0 will be latent.
     - On day 2 unit 0 will be Infectious Clinical.  It will be detected, and
       unit 1 will be marked for vaccination because it is within 10 km of a
       detected unit.
     - On day 3 nothing new will happen.
     - On day 4 nothing new will happen.
     - On day 5 unit 0 will no longer be infectious.  Because there are no
       infectious units left and nothing left to do, the simulation can end.
  </parameter-description>

  <output>
    <tr>
      <td>num-units-awaiting-vaccination</td>
      <td>num-animals-awaiting-vaccination</td>
      <td>num-units-vaccinated</td>
      <td>num-animals-vaccinated</td>
      <td>peak-num-units-awaiting-vaccination</td>
      <td>peak-num-animals-awaiting-vaccination</td>
      <td>peak-vaccination-wait-time</td>
      <td>average-vaccination-wait-time</td>
    </tr>
    <tr><td>0</td>   <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>   <td>0</td>  <td>0</td>  <td>0</td></tr>
    <tr><td>1</td>  <td>25</td>  <td>0</td>  <td>0</td>  <td>1</td>  <td>25</td>  <td>0</td>  <td>0</td></tr>
    <tr><td>1</td>  <td>25</td>  <td>0</td>  <td>0</td>  <td>1</td>  <td>25</td>  <td>1</td>  <td>1</td></tr>
    <tr><td>1</td>  <td>25</td>  <td>0</td>  <td>0</td>  <td>1</td>  <td>25</td>  <td>2</td>  <td>2</td></tr>
    <tr><td>1</td>  <td>25</td>  <td>0</td>  <td>0</td>  <td>1</td>  <td>25</td>  <td>3</td>  <td>3</td></tr>
  </output>
</variable-test>

<deterministic-test>
  <category>ring-vaccination</category>
  <short-name>early exit 4</short-name>

  <description>
    Test that the simulation's early-exit rules are followed with respect to
    units waiting for vaccination.
    
    In the tests "early exit" 4-6, there are three units.  Unit 0 is infected.
    On day 1 unit 0 is detected and units 1 and 2 are marked for vaccination.
    Different effects can be observed when a) there are resources to vaccinate
    both units, b) there are resources to vaccinate one unit, then later there
    are resources to vaccinate the other, or c) there are resources to
    vaccinate one unit, but never resources to vaccinate the other.

    In this scenario, there are resources to vaccinate both units.
  </description>

  <author>Neil Harvey &lt;neilharvey@gmail.com&gt;</author>
  <creation-date>21 Feb 2006</creation-date>
  <model-version>3.0</model-version>

  <herd-file>3herds_pigs_cattle_sheep_sheep_infected</herd-file>

  <parameter-file>early_exit_4</parameter-file>

  <parameter-description>
    For all production types, the latent period lasts 1 day, infectiousness
    lasts 3 days, clinical signs accompany infectiousness immediately, and
    natural immunity lasts 3 days.

    There is no spread.
    
    The probability of detecting a diseased unit vs. the number of days the
    animals have been showing clinical signs is fixed at 1. The probability of
    detecting a diseased unit vs. the number of days since a public
    announcement of an outbreak is also fixed at 1.

    A vaccination program begins at the first detection.  The authorities will
    vaccinate units within 20 km of a detected unit.  On the first 4 days that
    vaccinations could occur, the vaccination capacity will be zero.  The next
    day and forward, the vaccination capacity is 2 units per day.  The vaccine
    produces immunity immediately, and the immunity lasts 5 days.

    There is no destruction.

    Recapping what should happen as a result of all this:
     - On day 1 unit 0 will be latent.
     - On day 2 unit 0 will be Infectious Clinical.  It will be detected, and
       units 1 and 2 will be marked for vaccination because they are within 20
       km of a detected unit.
     - Day 3 is the first day that vaccinations could happen, but there will be
       no vaccination capacity for 4 days.
     - On day 4 there will be no vaccination capacity for another 3 days.
     - On day 5 unit 0 will no longer be infectious.  However, the simulation
       will keep going because there are still vaccination tasks to be done.
       There will be no vaccination capacity for another 2 days.
     - On day 6 there will be no vaccination capacity for another 1 day.
     - On day 7 units 1 and 2 will be vaccinated.
     - On day 8 units 1 and 2 will show as Immune.  Because there are no
       infectious units left and nothing left to do, the simulation can end.
  </parameter-description>

  <output>
    <tr><td>Latent</td>              <td>Susceptible</td>    <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>Susceptible</td>    <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>Susceptible</td>    <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>Susceptible</td>    <td>Susceptible</td></tr>
    <tr><td>NaturallyImmune</td>     <td>Susceptible</td>    <td>Susceptible</td></tr>
    <tr><td>NaturallyImmune</td>     <td>Susceptible</td>    <td>Susceptible</td></tr>
    <tr><td>NaturallyImmune</td>     <td>Susceptible</td>    <td>Susceptible</td></tr>
    <tr><td>Susceptible</td>         <td>VaccineImmune</td>  <td>VaccineImmune</td></tr>
    <!-- No infectious units, simulation stops. -->
  </output>
</deterministic-test>

<variable-test>
  <category>ring-vaccination</category>
  <short-name>early exit 4, check reporting variables</short-name>

  <description>
    Test that the number of units and number of animals awaiting vaccination
    are reported correctly.  This scenario is identical to "early exit 4"
    above.
  </description>

  <author>Neil Harvey &lt;neilharvey@gmail.com&gt;</author>
  <creation-date>3 Oct 2006</creation-date>
  <model-version>3.0</model-version>

  <herd-file>3herds_pigs_cattle_sheep_sheep_infected</herd-file>

  <parameter-file>early_exit_4_w_vars</parameter-file>

  <parameter-description>
    For all production types, the latent period lasts 1 day, infectiousness
    lasts 3 days, clinical signs accompany infectiousness immediately, and
    natural immunity lasts 3 days.

    There is no spread.
    
    The probability of detecting a diseased unit vs. the number of days the
    animals have been showing clinical signs is fixed at 1. The probability of
    detecting a diseased unit vs. the number of days since a public
    announcement of an outbreak is also fixed at 1.

    A vaccination program begins at the first detection.  The authorities will
    vaccinate units within 20 km of a detected unit.  On the first 4 days that
    vaccinations could occur, the vaccination capacity will be zero.  The next
    day and forward, the vaccination capacity is 2 units per day.  The vaccine
    produces immunity immediately, and the immunity lasts 5 days.

    There is no destruction.

    Recapping what should happen as a result of all this:
     - On day 1 unit 0 will be latent.
     - On day 2 unit 0 will be Infectious Clinical.  It will be detected, and
       units 1 and 2 will be marked for vaccination because they are within 20
       km of a detected unit.
     - Day 3 is the first day that vaccinations could happen, but there will be
       no vaccination capacity for 4 days.
     - On day 4 there will be no vaccination capacity for another 3 days.
     - On day 5 unit 0 will no longer be infectious.  However, the simulation
       will keep going because there are still vaccination tasks to be done.
       There will be no vaccination capacity for another 2 days.
     - On day 6 there will be no vaccination capacity for another 1 day.
     - On day 7 units 1 and 2 will be vaccinated.
     - On day 8 units 1 and 2 will show as Immune.  Because there are no
       infectious units left and nothing left to do, the simulation can end.
  </parameter-description>

  <output>
    <tr>
      <td>num-units-awaiting-vaccination</td>
      <td>num-animals-awaiting-vaccination</td>
      <td>num-units-vaccinated</td>
      <td>num-animals-vaccinated</td>
      <td>peak-num-units-awaiting-vaccination</td>
      <td>peak-num-animals-awaiting-vaccination</td>
      <td>peak-vaccination-wait-time</td>
      <td>average-vaccination-wait-time</td>
    </tr>
    <tr><td>0</td>   <td>0</td>  <td>0</td>   <td>0</td>  <td>0</td>   <td>0</td>  <td>0</td>  <td>0</td></tr>
    <tr><td>2</td>  <td>50</td>  <td>0</td>   <td>0</td>  <td>2</td>  <td>50</td>  <td>0</td>  <td>0</td></tr>
    <tr><td>2</td>  <td>50</td>  <td>0</td>   <td>0</td>  <td>2</td>  <td>50</td>  <td>1</td>  <td>1</td></tr>
    <tr><td>2</td>  <td>50</td>  <td>0</td>   <td>0</td>  <td>2</td>  <td>50</td>  <td>2</td>  <td>2</td></tr>
    <tr><td>2</td>  <td>50</td>  <td>0</td>   <td>0</td>  <td>2</td>  <td>50</td>  <td>3</td>  <td>3</td></tr>
    <tr><td>2</td>  <td>50</td>  <td>0</td>   <td>0</td>  <td>2</td>  <td>50</td>  <td>4</td>  <td>4</td></tr>
    <tr><td>0</td>   <td>0</td>  <td>2</td>  <td>50</td>  <td>2</td>  <td>50</td>  <td>5</td>  <td>5</td></tr>
    <tr><td>0</td>   <td>0</td>  <td>0</td>   <td>0</td>  <td>2</td>  <td>50</td>  <td>5</td>  <td>5</td></tr>
  </output>
</variable-test>

<variable-test>
  <category>ring-vaccination</category>
  <short-name>early exit 4, check reporting variables 2</short-name>

  <description>
    Test that the number of units and number of animals awaiting vaccination
    are reported correctly.  Use the broken down by production type outputs.
    This scenario is identical to "early exit 4" above.
  </description>

  <author>Neil Harvey &lt;neilharvey@gmail.com&gt;</author>
  <creation-date>3 Oct 2006</creation-date>
  <model-version>3.0</model-version>

  <herd-file>3herds_pigs_cattle_sheep_sheep_infected</herd-file>

  <parameter-file>early_exit_4_w_vars2</parameter-file>

  <parameter-description>
    For all production types, the latent period lasts 1 day, infectiousness
    lasts 3 days, clinical signs accompany infectiousness immediately, and
    natural immunity lasts 3 days.

    There is no spread.
    
    The probability of detecting a diseased unit vs. the number of days the
    animals have been showing clinical signs is fixed at 1. The probability of
    detecting a diseased unit vs. the number of days since a public
    announcement of an outbreak is also fixed at 1.

    A vaccination program begins at the first detection.  The authorities will
    vaccinate units within 20 km of a detected unit.  On the first 4 days that
    vaccinations could occur, the vaccination capacity will be zero.  The next
    day and forward, the vaccination capacity is 2 units per day.  The vaccine
    produces immunity immediately, and the immunity lasts 5 days.

    There is no destruction.

    Recapping what should happen as a result of all this:
     - On day 1 unit 0 will be latent.
     - On day 2 unit 0 will be Infectious Clinical.  It will be detected, and
       units 1 and 2 will be marked for vaccination because they are within 20
       km of a detected unit.
     - Day 3 is the first day that vaccinations could happen, but there will be
       no vaccination capacity for 4 days.
     - On day 4 there will be no vaccination capacity for another 3 days.
     - On day 5 unit 0 will no longer be infectious.  However, the simulation
       will keep going because there are still vaccination tasks to be done.
       There will be no vaccination capacity for another 2 days.
     - On day 6 there will be no vaccination capacity for another 1 day.
     - On day 7 units 1 and 2 will be vaccinated.
     - On day 8 units 1 and 2 will show as Immune.  Because there are no
       infectious units left and nothing left to do, the simulation can end.
  </parameter-description>

  <output>
    <tr>
      <td>num-units-awaiting-vaccination-by-production-type:Sheep</td>
      <td>num-units-awaiting-vaccination-by-production-type:Beef Cattle</td>
      <td>num-units-awaiting-vaccination-by-production-type:Pigs</td>
      <td>num-animals-awaiting-vaccination-by-production-type:Sheep</td>
      <td>num-animals-awaiting-vaccination-by-production-type:Beef Cattle</td>
      <td>num-animals-awaiting-vaccination-by-production-type:Pigs</td>
      <td>num-units-vaccinated-by-production-type:Sheep</td>
      <td>num-units-vaccinated-by-production-type:Beef Cattle</td>
      <td>num-units-vaccinated-by-production-type:Pigs</td>
      <td>num-animals-vaccinated-by-production-type:Sheep</td>
      <td>num-animals-vaccinated-by-production-type:Beef Cattle</td>
      <td>num-animals-vaccinated-by-production-type:Pigs</td>
    </tr>
    <!--  # units waiting                     # animals waiting                     # units vaccinated                  # animals vaccinated                -->
    <!--  Sheep       Cattle      Pigs        Sheep        Cattle       Pigs        Sheep       Cattle      Pigs        Sheep        Cattle       Pigs      -->
    <tr><td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>   <td>0</td>   <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>   <td>0</td>   <td>0</td></tr>
    <tr><td>0</td>  <td>1</td>  <td>1</td>  <td>0</td>  <td>25</td>  <td>25</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>   <td>0</td>   <td>0</td></tr>
    <tr><td>0</td>  <td>1</td>  <td>1</td>  <td>0</td>  <td>25</td>  <td>25</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>   <td>0</td>   <td>0</td></tr>
    <tr><td>0</td>  <td>1</td>  <td>1</td>  <td>0</td>  <td>25</td>  <td>25</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>   <td>0</td>   <td>0</td></tr>
    <tr><td>0</td>  <td>1</td>  <td>1</td>  <td>0</td>  <td>25</td>  <td>25</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>   <td>0</td>   <td>0</td></tr>
    <tr><td>0</td>  <td>1</td>  <td>1</td>  <td>0</td>  <td>25</td>  <td>25</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>   <td>0</td>   <td>0</td></tr>
    <tr><td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>   <td>0</td>   <td>0</td>  <td>0</td>  <td>1</td>  <td>1</td>  <td>0</td>  <td>25</td>  <td>25</td></tr>
    <tr><td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>   <td>0</td>   <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>   <td>0</td>   <td>0</td></tr>
  </output>
</variable-test>

<deterministic-test>
  <category>ring-vaccination</category>
  <short-name>early exit 5</short-name>

  <description>
    Test that the simulation's early-exit rules are followed with respect to
    units waiting for vaccination.
    
    In the tests "early exit" 4-6, there are three units.  Unit 0 is infected.
    On day 1 unit 0 is detected and units 1 and 2 are marked for vaccination.
    Different effects can be observed when a) there are resources to vaccinate
    both units, b) there are resources to vaccinate one unit, then later there
    are resources to vaccinate the other, or c) there are resources to
    vaccinate one unit, but never resources to vaccinate the other.

    In this scenario, there are resources to vaccinate one unit, then later
    there are resources to vaccinate the other.
  </description>

  <author>Neil Harvey &lt;neilharvey@gmail.com&gt;</author>
  <creation-date>21 Feb 2006</creation-date>
  <model-version>3.0</model-version>

  <herd-file>3herds_pigs_cattle_sheep_sheep_infected</herd-file>

  <parameter-file>early_exit_5</parameter-file>

  <parameter-description>
    For all production types, the latent period lasts 1 day, infectiousness
    lasts 3 days, clinical signs accompany infectiousness immediately, and
    natural immunity lasts 3 days.

    There is no spread.
    
    The probability of detecting a diseased unit vs. the number of days the
    animals have been showing clinical signs is fixed at 1. The probability of
    detecting a diseased unit vs. the number of days since a public
    announcement of an outbreak is also fixed at 1.

    A vaccination program begins at the first detection.  The authorities will
    vaccinate units within 20 km of a detected unit.  On the first 4 days that
    vaccinations could occur, the vaccination capacity will be zero.  The next
    day, the vaccination capacity is 1 unit.  Another day of zero capacity
    follows, then on the next day and forward the vaccination capacity is 1
    unit per day.  Cattle have priority over pigs.  The vaccine produces
    immunity immediately, and the immunity lasts 5 days.

    There is no destruction.

    Recapping what should happen as a result of all this:
     - On day 1 unit 0 will be latent.
     - On day 2 unit 0 will be Infectious Clinical.  It will be detected, and
       units 1 and 2 will be marked for vaccination because they are within 20
       km of a detected unit.
     - Day 3 is the first day that vaccinations could happen, but there will be
       no vaccination capacity for 4 days.
     - On day 4 there will be no vaccination capacity for another 3 days.
     - On day 5 unit 0 will no longer be infectious.  However, the simulation
       will keep going because there are still vaccination tasks to be done.
       There will be no vaccination capacity for another 2 days.
     - On day 6 there will be no vaccination capacity for another 1 day.
     - On day 7 there is capacity to vaccinate 1 unit.  Unit 1 will be chosen
       because cattle have priority over pigs.
     - On day 8 unit 1's state will show as Immune.  There is no capacity to
       vaccinate on day 8.
     - On day 9 there is capacity to vaccinate 1 unit.  Unit 2 will be
       vaccinated.
     - On day 10 unit 2's state will show as Immune.  Because there are no
       infectious units left and nothing left to do, the simulation can end.
  </parameter-description>

  <output>
    <tr><td>Latent</td>              <td>Susceptible</td>    <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>Susceptible</td>    <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>Susceptible</td>    <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>Susceptible</td>    <td>Susceptible</td></tr>
    <tr><td>NaturallyImmune</td>     <td>Susceptible</td>    <td>Susceptible</td></tr>
    <tr><td>NaturallyImmune</td>     <td>Susceptible</td>    <td>Susceptible</td></tr>
    <tr><td>NaturallyImmune</td>     <td>Susceptible</td>    <td>Susceptible</td></tr>
    <tr><td>Susceptible</td>         <td>VaccineImmune</td>  <td>Susceptible</td></tr>
    <tr><td>Susceptible</td>         <td>VaccineImmune</td>  <td>Susceptible</td></tr>
    <tr><td>Susceptible</td>         <td>VaccineImmune</td>  <td>VaccineImmune</td></tr>
    <!-- No infectious units, simulation stops. -->
  </output>
</deterministic-test>

<variable-test>
  <category>ring-vaccination</category>
  <short-name>early exit 5, check reporting variables</short-name>

  <description>
    Test that the number of units and number of animals awaiting vaccination
    are reported correctly.  This scenario is identical to "early exit 5"
    above.
  </description>

  <author>Neil Harvey &lt;neilharvey@gmail.com&gt;</author>
  <creation-date>3 Oct 2006</creation-date>
  <model-version>3.0</model-version>

  <herd-file>3herds_pigs_cattle_sheep_sheep_infected</herd-file>

  <parameter-file>early_exit_5_w_vars</parameter-file>

  <parameter-description>
    For all production types, the latent period lasts 1 day, infectiousness
    lasts 3 days, clinical signs accompany infectiousness immediately, and
    natural immunity lasts 3 days.

    There is no spread.
    
    The probability of detecting a diseased unit vs. the number of days the
    animals have been showing clinical signs is fixed at 1. The probability of
    detecting a diseased unit vs. the number of days since a public
    announcement of an outbreak is also fixed at 1.

    A vaccination program begins at the first detection.  The authorities will
    vaccinate units within 20 km of a detected unit.  On the first 4 days that
    vaccinations could occur, the vaccination capacity will be zero.  The next
    day, the vaccination capacity is 1 unit.  Another day of zero capacity
    follows, then on the next day and forward the vaccination capacity is 1
    unit per day.  Cattle have priority over pigs.  The vaccine produces
    immunity immediately, and the immunity lasts 5 days.

    There is no destruction.

    Recapping what should happen as a result of all this:
     - On day 1 unit 0 will be latent.
     - On day 2 unit 0 will be Infectious Clinical.  It will be detected, and
       units 1 and 2 will be marked for vaccination because they are within 20
       km of a detected unit.
     - Day 3 is the first day that vaccinations could happen, but there will be
       no vaccination capacity for 4 days.
     - On day 4 there will be no vaccination capacity for another 3 days.
     - On day 5 unit 0 will no longer be infectious.  However, the simulation
       will keep going because there are still vaccination tasks to be done.
       There will be no vaccination capacity for another 2 days.
     - On day 6 there will be no vaccination capacity for another 1 day.
     - On day 7 there is capacity to vaccinate 1 unit.  Unit 1 will be chosen
       because cattle have priority over pigs.  The average wait time will be 5
       (both units have been waiting for 5 days).
     - On day 8 unit 1's state will show as Immune.  There is no capacity to
       vaccinate on day 8.  The average wait time will be 5.5 (unit 1 waited 5
       days, unit 2 has been waiting for 6 days).
     - On day 9 there is capacity to vaccinate 1 unit.  Unit 2 will be
       vaccinated.  The average wait time will be 6 (unit 1 waited 5 days, unit
       2 waited 7 days).
     - On day 10 unit 2's state will show as Immune.  Because there are no
       infectious units left and nothing left to do, the simulation can end.
  </parameter-description>

  <output>
    <tr>
      <td>num-units-awaiting-vaccination</td>
      <td>num-animals-awaiting-vaccination</td>
      <td>num-units-vaccinated</td>
      <td>num-animals-vaccinated</td>
      <td>peak-num-units-awaiting-vaccination</td>
      <td>peak-num-animals-awaiting-vaccination</td>
      <td>peak-vaccination-wait-time</td>
      <td>average-vaccination-wait-time</td>
    </tr>
    <tr><td>0</td>   <td>0</td>  <td>0</td>   <td>0</td>  <td>0</td>   <td>0</td>  <td>0</td>  <td>0</td></tr>
    <tr><td>2</td>  <td>50</td>  <td>0</td>   <td>0</td>  <td>2</td>  <td>50</td>  <td>0</td>  <td>0</td></tr>
    <tr><td>2</td>  <td>50</td>  <td>0</td>   <td>0</td>  <td>2</td>  <td>50</td>  <td>1</td>  <td>1</td></tr>
    <tr><td>2</td>  <td>50</td>  <td>0</td>   <td>0</td>  <td>2</td>  <td>50</td>  <td>2</td>  <td>2</td></tr>
    <tr><td>2</td>  <td>50</td>  <td>0</td>   <td>0</td>  <td>2</td>  <td>50</td>  <td>3</td>  <td>3</td></tr>
    <tr><td>2</td>  <td>50</td>  <td>0</td>   <td>0</td>  <td>2</td>  <td>50</td>  <td>4</td>  <td>4</td></tr>
    <tr><td>1</td>  <td>25</td>  <td>1</td>  <td>25</td>  <td>2</td>  <td>50</td>  <td>5</td>  <td>5</td></tr>
    <tr><td>1</td>  <td>25</td>  <td>0</td>   <td>0</td>  <td>2</td>  <td>50</td>  <td>6</td>  <td>5.5</td></tr>
    <tr><td>0</td>   <td>0</td>  <td>1</td>  <td>25</td>  <td>2</td>  <td>50</td>  <td>7</td>  <td>6</td></tr>
    <tr><td>0</td>   <td>0</td>  <td>0</td>   <td>0</td>  <td>2</td>  <td>50</td>  <td>7</td>  <td>6</td></tr>
  </output>
</variable-test>

<variable-test>
  <category>ring-vaccination</category>
  <short-name>early exit 5, check reporting variables 2</short-name>

  <description>
    Test that the number of units and number of animals awaiting vaccination
    are reported correctly.  Use the broken down by production type outputs.
    This scenario is identical to "early exit 5" above.
  </description>

  <author>Neil Harvey &lt;neilharvey@gmail.com&gt;</author>
  <creation-date>3 Oct 2006</creation-date>
  <model-version>3.0</model-version>

  <herd-file>3herds_pigs_cattle_sheep_sheep_infected</herd-file>

  <parameter-file>early_exit_5_w_vars2</parameter-file>

  <parameter-description>
    For all production types, the latent period lasts 1 day, infectiousness
    lasts 3 days, clinical signs accompany infectiousness immediately, and
    natural immunity lasts 3 days.

    There is no spread.
    
    The probability of detecting a diseased unit vs. the number of days the
    animals have been showing clinical signs is fixed at 1. The probability of
    detecting a diseased unit vs. the number of days since a public
    announcement of an outbreak is also fixed at 1.

    A vaccination program begins at the first detection.  The authorities will
    vaccinate units within 20 km of a detected unit.  On the first 4 days that
    vaccinations could occur, the vaccination capacity will be zero.  The next
    day, the vaccination capacity is 1 unit.  Another day of zero capacity
    follows, then on the next day and forward the vaccination capacity is 1
    unit per day.  Cattle have priority over pigs.  The vaccine produces
    immunity immediately, and the immunity lasts 5 days.

    There is no destruction.

    Recapping what should happen as a result of all this:
     - On day 1 unit 0 will be latent.
     - On day 2 unit 0 will be Infectious Clinical.  It will be detected, and
       units 1 and 2 will be marked for vaccination because they are within 20
       km of a detected unit.
     - Day 3 is the first day that vaccinations could happen, but there will be
       no vaccination capacity for 4 days.
     - On day 4 there will be no vaccination capacity for another 3 days.
     - On day 5 unit 0 will no longer be infectious.  However, the simulation
       will keep going because there are still vaccination tasks to be done.
       There will be no vaccination capacity for another 2 days.
     - On day 6 there will be no vaccination capacity for another 1 day.
     - On day 7 there is capacity to vaccinate 1 unit.  Unit 1 will be chosen
       because cattle have priority over pigs.
     - On day 8 unit 1's state will show as Immune.  There is no capacity to
       vaccinate on day 8.
     - On day 9 there is capacity to vaccinate 1 unit.  Unit 2 will be
       vaccinated.
     - On day 10 unit 2's state will show as Immune.  Because there are no
       infectious units left and nothing left to do, the simulation can end.
  </parameter-description>

  <output>
    <tr>
      <td>num-units-awaiting-vaccination-by-production-type:Sheep</td>
      <td>num-units-awaiting-vaccination-by-production-type:Beef Cattle</td>
      <td>num-units-awaiting-vaccination-by-production-type:Pigs</td>
      <td>num-animals-awaiting-vaccination-by-production-type:Sheep</td>
      <td>num-animals-awaiting-vaccination-by-production-type:Beef Cattle</td>
      <td>num-animals-awaiting-vaccination-by-production-type:Pigs</td>
      <td>num-units-vaccinated-by-production-type:Sheep</td>
      <td>num-units-vaccinated-by-production-type:Beef Cattle</td>
      <td>num-units-vaccinated-by-production-type:Pigs</td>
      <td>num-animals-vaccinated-by-production-type:Sheep</td>
      <td>num-animals-vaccinated-by-production-type:Beef Cattle</td>
      <td>num-animals-vaccinated-by-production-type:Pigs</td>
    </tr>
    <!--  # units waiting                     # animals waiting                     # units vaccinated                  # animals vaccinated                -->
    <!--  Sheep       Cattle      Pigs        Sheep        Cattle       Pigs        Sheep       Cattle      Pigs        Sheep        Cattle       Pigs      -->
    <tr><td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>   <td>0</td>   <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>   <td>0</td>   <td>0</td></tr>
    <tr><td>0</td>  <td>1</td>  <td>1</td>  <td>0</td>  <td>25</td>  <td>25</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>   <td>0</td>   <td>0</td></tr>
    <tr><td>0</td>  <td>1</td>  <td>1</td>  <td>0</td>  <td>25</td>  <td>25</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>   <td>0</td>   <td>0</td></tr>
    <tr><td>0</td>  <td>1</td>  <td>1</td>  <td>0</td>  <td>25</td>  <td>25</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>   <td>0</td>   <td>0</td></tr>
    <tr><td>0</td>  <td>1</td>  <td>1</td>  <td>0</td>  <td>25</td>  <td>25</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>   <td>0</td>   <td>0</td></tr>
    <tr><td>0</td>  <td>1</td>  <td>1</td>  <td>0</td>  <td>25</td>  <td>25</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>   <td>0</td>   <td>0</td></tr>
    <tr><td>0</td>  <td>0</td>  <td>1</td>  <td>0</td>   <td>0</td>  <td>25</td>  <td>0</td>  <td>1</td>  <td>0</td>  <td>0</td>  <td>25</td>   <td>0</td></tr>
    <tr><td>0</td>  <td>0</td>  <td>1</td>  <td>0</td>   <td>0</td>  <td>25</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>   <td>0</td>   <td>0</td></tr>
    <tr><td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>   <td>0</td>   <td>0</td>  <td>0</td>  <td>0</td>  <td>1</td>  <td>0</td>   <td>0</td>  <td>25</td></tr>
    <tr><td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>   <td>0</td>   <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>   <td>0</td>   <td>0</td></tr>
  </output>
</variable-test>

<deterministic-test>
  <category>ring-vaccination</category>
  <short-name>early exit 6</short-name>

  <description>
    Test that the simulation's early-exit rules are followed with respect to
    units waiting for vaccination.
    
    In the tests "early exit" 4-6, there are three units.  Unit 0 is infected.
    On day 1 unit 0 is detected and units 1 and 2 are marked for vaccination.
    Different effects can be observed when a) there are resources to vaccinate
    both units, b) there are resources to vaccinate one unit, then later there
    are resources to vaccinate the other, or c) there are resources to
    vaccinate one unit, but never resources to vaccinate the other.

    In this scenario, there are resources to vaccinate one unit, but never
    resources to vaccinate the other.
  </description>

  <author>Neil Harvey &lt;neilharvey@gmail.com&gt;</author>
  <creation-date>21 Feb 2006</creation-date>
  <model-version>3.0</model-version>

  <herd-file>3herds_pigs_cattle_sheep_sheep_infected</herd-file>

  <parameter-file>early_exit_6</parameter-file>

  <parameter-description>
    For all production types, the latent period lasts 1 day, infectiousness
    lasts 3 days, clinical signs accompany infectiousness immediately, and
    natural immunity lasts 3 days.

    There is no spread.
    
    The probability of detecting a diseased unit vs. the number of days the
    animals have been showing clinical signs is fixed at 1. The probability of
    detecting a diseased unit vs. the number of days since a public
    announcement of an outbreak is also fixed at 1.

    A vaccination program begins at the first detection.  The authorities will
    vaccinate units within 20 km of a detected unit.  On the first 4 days that
    vaccinations could occur, the vaccination capacity will be zero.  The next
    day, the vaccination capacity is 1 unit.  All subsequent days have zero
    capacity.  Cattle have priority over pigs.  The vaccine produces immunity
    immediately, and the immunity lasts 5 days.

    There is no destruction.

    Recapping what should happen as a result of all this:
     - On day 1 unit 0 will be latent.
     - On day 2 unit 0 will be Infectious Clinical.  It will be detected, and
       units 1 and 2 will be marked for vaccination because they are within 20
       km of a detected unit.
     - Day 3 is the first day that vaccinations could happen, but there will be
       no vaccination capacity for 4 days.
     - On day 4 there will be no vaccination capacity for another 3 days.
     - On day 5 unit 0 will no longer be infectious.  However, the simulation
       will keep going because there are still vaccination tasks to be done.
       There will be no vaccination capacity for another 2 days.
     - On day 6 there will be no vaccination capacity for another 1 day.
     - On day 7 there is capacity to vaccinate 1 unit.  Unit 1 will be chosen
       because cattle have priority over pigs.
     - On day 8 unit 1's state will show as Immune.  Because there are no
       infectious units left and nothing left to do, the simulation can end.
  </parameter-description>

  <output>
    <tr><td>Latent</td>              <td>Susceptible</td>    <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>Susceptible</td>    <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>Susceptible</td>    <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>Susceptible</td>    <td>Susceptible</td></tr>
    <tr><td>NaturallyImmune</td>     <td>Susceptible</td>    <td>Susceptible</td></tr>
    <tr><td>NaturallyImmune</td>     <td>Susceptible</td>    <td>Susceptible</td></tr>
    <tr><td>NaturallyImmune</td>     <td>Susceptible</td>    <td>Susceptible</td></tr>
    <tr><td>Susceptible</td>         <td>VaccineImmune</td>  <td>Susceptible</td></tr>
    <!-- No infectious units, simulation stops. -->
  </output>
</deterministic-test>

<variable-test>
  <category>ring-vaccination</category>
  <short-name>early exit 6, check reporting variables</short-name>

  <description>
    Test that the number of units and number of animals awaiting vaccination
    are reported correctly.  This scenario is identical to "early exit 6"
    above.
  </description>

  <author>Neil Harvey &lt;neilharvey@gmail.com&gt;</author>
  <creation-date>3 Oct 2006</creation-date>
  <model-version>3.0</model-version>

  <herd-file>3herds_pigs_cattle_sheep_sheep_infected</herd-file>

  <parameter-file>early_exit_6_w_vars</parameter-file>

  <parameter-description>
    For all production types, the latent period lasts 1 day, infectiousness
    lasts 3 days, clinical signs accompany infectiousness immediately, and
    natural immunity lasts 3 days.

    There is no spread.
    
    The probability of detecting a diseased unit vs. the number of days the
    animals have been showing clinical signs is fixed at 1. The probability of
    detecting a diseased unit vs. the number of days since a public
    announcement of an outbreak is also fixed at 1.

    A vaccination program begins at the first detection.  The authorities will
    vaccinate units within 20 km of a detected unit.  On the first 4 days that
    vaccinations could occur, the vaccination capacity will be zero.  The next
    day, the vaccination capacity is 1 unit.  All subsequent days have zero
    capacity.  Cattle have priority over pigs.  The vaccine produces immunity
    immediately, and the immunity lasts 5 days.

    There is no destruction.

    Recapping what should happen as a result of all this:
     - On day 1 unit 0 will be latent.
     - On day 2 unit 0 will be Infectious Clinical.  It will be detected, and
       units 1 and 2 will be marked for vaccination because they are within 20
       km of a detected unit.
     - Day 3 is the first day that vaccinations could happen, but there will be
       no vaccination capacity for 4 days.
     - On day 4 there will be no vaccination capacity for another 3 days.
     - On day 5 unit 0 will no longer be infectious.  However, the simulation
       will keep going because there are still vaccination tasks to be done.
       There will be no vaccination capacity for another 2 days.
     - On day 6 there will be no vaccination capacity for another 1 day.
     - On day 7 there is capacity to vaccinate 1 unit.  Unit 1 will be chosen
       because cattle have priority over pigs.  The average wait time will be 5
       (both units have been waiting for 5 days).
     - On day 8 unit 1's state will show as Immune.  The average wait time will
       be 5.5 (unit 1 waited 5 days, unit 2 has been waiting for 6 days).
       Because there are no infectious units left and nothing left to do, the
       simulation can end.
  </parameter-description>

  <output>
    <tr>
      <td>num-units-awaiting-vaccination</td>
      <td>num-animals-awaiting-vaccination</td>
      <td>num-units-vaccinated</td>
      <td>num-animals-vaccinated</td>
      <td>peak-num-units-awaiting-vaccination</td>
      <td>peak-num-animals-awaiting-vaccination</td>
      <td>peak-vaccination-wait-time</td>
      <td>average-vaccination-wait-time</td>
    </tr>
    <tr><td>0</td>   <td>0</td>  <td>0</td>   <td>0</td>  <td>0</td>   <td>0</td>  <td>0</td>  <td>0</td></tr>
    <tr><td>2</td>  <td>50</td>  <td>0</td>   <td>0</td>  <td>2</td>  <td>50</td>  <td>0</td>  <td>0</td></tr>
    <tr><td>2</td>  <td>50</td>  <td>0</td>   <td>0</td>  <td>2</td>  <td>50</td>  <td>1</td>  <td>1</td></tr>
    <tr><td>2</td>  <td>50</td>  <td>0</td>   <td>0</td>  <td>2</td>  <td>50</td>  <td>2</td>  <td>2</td></tr>
    <tr><td>2</td>  <td>50</td>  <td>0</td>   <td>0</td>  <td>2</td>  <td>50</td>  <td>3</td>  <td>3</td></tr>
    <tr><td>2</td>  <td>50</td>  <td>0</td>   <td>0</td>  <td>2</td>  <td>50</td>  <td>4</td>  <td>4</td></tr>
    <tr><td>1</td>  <td>25</td>  <td>1</td>  <td>25</td>  <td>2</td>  <td>50</td>  <td>5</td>  <td>5</td></tr>
    <tr><td>1</td>  <td>25</td>  <td>0</td>   <td>0</td>  <td>2</td>  <td>50</td>  <td>6</td>  <td>5.5</td></tr>
  </output>
</variable-test>

<variable-test>
  <category>ring-vaccination</category>
  <short-name>early exit 6, check reporting variables 2</short-name>

  <description>
    Test that the number of units and number of animals awaiting vaccination
    are reported correctly.  Use the broken down by production type outputs.
    This scenario is identical to "early exit 6" above.
  </description>

  <author>Neil Harvey &lt;neilharvey@gmail.com&gt;</author>
  <creation-date>3 Oct 2006</creation-date>
  <model-version>3.0</model-version>

  <herd-file>3herds_pigs_cattle_sheep_sheep_infected</herd-file>

  <parameter-file>early_exit_6_w_vars2</parameter-file>

  <parameter-description>
    For all production types, the latent period lasts 1 day, infectiousness
    lasts 3 days, clinical signs accompany infectiousness immediately, and
    natural immunity lasts 3 days.

    There is no spread.
    
    The probability of detecting a diseased unit vs. the number of days the
    animals have been showing clinical signs is fixed at 1. The probability of
    detecting a diseased unit vs. the number of days since a public
    announcement of an outbreak is also fixed at 1.

    A vaccination program begins at the first detection.  The authorities will
    vaccinate units within 20 km of a detected unit.  On the first 4 days that
    vaccinations could occur, the vaccination capacity will be zero.  The next
    day, the vaccination capacity is 1 unit.  All subsequent days have zero
    capacity.  Cattle have priority over pigs.  The vaccine produces immunity
    immediately, and the immunity lasts 5 days.

    There is no destruction.

    Recapping what should happen as a result of all this:
     - On day 1 unit 0 will be latent.
     - On day 2 unit 0 will be Infectious Clinical.  It will be detected, and
       units 1 and 2 will be marked for vaccination because they are within 20
       km of a detected unit.
     - Day 3 is the first day that vaccinations could happen, but there will be
       no vaccination capacity for 4 days.
     - On day 4 there will be no vaccination capacity for another 3 days.
     - On day 5 unit 0 will no longer be infectious.  However, the simulation
       will keep going because there are still vaccination tasks to be done.
       There will be no vaccination capacity for another 2 days.
     - On day 6 there will be no vaccination capacity for another 1 day.
     - On day 7 there is capacity to vaccinate 1 unit.  Unit 1 will be chosen
       because cattle have priority over pigs.
     - On day 8 unit 1's state will show as Immune.  Because there are no
       infectious units left and nothing left to do, the simulation can end.
  </parameter-description>

  <output>
    <tr>
      <td>num-units-awaiting-vaccination-by-production-type:Sheep</td>
      <td>num-units-awaiting-vaccination-by-production-type:Beef Cattle</td>
      <td>num-units-awaiting-vaccination-by-production-type:Pigs</td>
      <td>num-animals-awaiting-vaccination-by-production-type:Sheep</td>
      <td>num-animals-awaiting-vaccination-by-production-type:Beef Cattle</td>
      <td>num-animals-awaiting-vaccination-by-production-type:Pigs</td>
      <td>num-units-vaccinated-by-production-type:Sheep</td>
      <td>num-units-vaccinated-by-production-type:Beef Cattle</td>
      <td>num-units-vaccinated-by-production-type:Pigs</td>
      <td>num-animals-vaccinated-by-production-type:Sheep</td>
      <td>num-animals-vaccinated-by-production-type:Beef Cattle</td>
      <td>num-animals-vaccinated-by-production-type:Pigs</td>
    </tr>
    <!--  # units waiting                     # animals waiting                     # units vaccinated                  # animals vaccinated                -->
    <!--  Sheep       Cattle      Pigs        Sheep        Cattle       Pigs        Sheep       Cattle      Pigs        Sheep        Cattle       Pigs      -->
    <tr><td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>   <td>0</td>   <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>   <td>0</td>   <td>0</td></tr>
    <tr><td>0</td>  <td>1</td>  <td>1</td>  <td>0</td>  <td>25</td>  <td>25</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>   <td>0</td>   <td>0</td></tr>
    <tr><td>0</td>  <td>1</td>  <td>1</td>  <td>0</td>  <td>25</td>  <td>25</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>   <td>0</td>   <td>0</td></tr>
    <tr><td>0</td>  <td>1</td>  <td>1</td>  <td>0</td>  <td>25</td>  <td>25</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>   <td>0</td>   <td>0</td></tr>
    <tr><td>0</td>  <td>1</td>  <td>1</td>  <td>0</td>  <td>25</td>  <td>25</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>   <td>0</td>   <td>0</td></tr>
    <tr><td>0</td>  <td>1</td>  <td>1</td>  <td>0</td>  <td>25</td>  <td>25</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>   <td>0</td>   <td>0</td></tr>
    <tr><td>0</td>  <td>0</td>  <td>1</td>  <td>0</td>   <td>0</td>  <td>25</td>  <td>0</td>  <td>1</td>  <td>0</td>  <td>0</td>  <td>25</td>   <td>0</td></tr>
    <tr><td>0</td>  <td>0</td>  <td>1</td>  <td>0</td>   <td>0</td>  <td>25</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>   <td>0</td>   <td>0</td></tr>
  </output>
</variable-test>

<deterministic-test>
  <category>ring-vaccination</category>
  <short-name>destroyed while waiting 1</short-name>

  <description>
    Test that the vaccination waiting list is updated correctly when a unit is
    destroyed while awaiting vaccination.
    
    In the tests "destroyed while waiting" 1-3, there are two units.  Unit 0 is
    infected.  On day 1 unit 0 is detected and unit 1 is marked for both
    vaccination and destruction.  Different effects can be observed when a)
    vaccination happens before destruction, b) destruction happens before
    vaccination, or c) vaccination and destruction actions come up on the same
    day.

    In this scenario, vaccination happens before destruction.
  </description>

  <author>Neil Harvey &lt;neilharvey@gmail.com&gt;</author>
  <creation-date>10 Oct 2006</creation-date>
  <model-version>3.0</model-version>

  <herd-file>2herds</herd-file>

  <parameter-file>destroyed_while_waiting_1</parameter-file>

  <parameter-description>
    The latent period lasts 1 day, infectiousness lasts 3 days, clinical signs
    accompany infectiousness immediately, and natural immunity lasts 3 days.

    There is no spread.
    
    The probability of detecting a diseased unit vs. the number of days the
    animals have been showing clinical signs is fixed at 1. The probability of
    detecting a diseased unit vs. the number of days since a public
    announcement of an outbreak is also fixed at 1.

    At the first detection, vaccination and destruction programs begin.  The
    authorities will both vaccinate and destroy units within 10 km of a
    detected unit.  (This might not be a sensible strategy, but it is a useful
    setup for this test.)  On the first 4 days that vaccinations could occur,
    the vaccination capacity will be zero.  The next day and forward, the
    vaccination capacity is 1 unit per day.  The vaccine produces immunity
    immediately, and the immunity lasts 5 days.

    On the first 6 days that destructions could occur, the destruction capacity
    will be zero.  The next day and forward, the destruction capacity is 1 unit
    per day.

    Recapping what should happen as a result of all this:
     - On day 1 unit 0 will be latent.
     - On day 2 unit 0 will be Infectious Clinical.  It will be detected, and
       unit 1 will be marked for vaccination because it is within 10 km of a
       detected unit.
     - Day 3 is the first day that vaccinations and destructions could happen,
       but there will be no vaccination capacity for 4 days and no destruction
       capacity for 6 days.
     - On day 4 there will be no vaccination capacity for another 3 days, and
       no destruction capacity for another 5 days.
     - On day 5 unit 0 will no longer be infectious.  However, the simulation
       will keep going because there are still vaccination and destruction
       tasks to be done.  There will be no vaccination capacity for another 2
       days, and no destruction capacity for another 4 days.
     - On day 6 there will be no vaccination capacity for another 1 day, and no
       destruction capacity for another 3 days.
     - On day 7 unit 1 will be vaccinated.  There will be no destruction
       capacity for another 2 days.
     - On day 8 unit 1's state will show as Immune.  There will be no
       destruction capacity for another 1 day.
     - On day 9 unit 2 will be destroyed.
     - On day 10 unit 1's state will show as Destroyed.  Because there are no
       infectious units left and nothing left to do, the simulation can end.
  </parameter-description>

  <output>
    <tr><td>Latent</td>              <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>Susceptible</td></tr>
    <tr><td>NaturallyImmune</td>     <td>Susceptible</td></tr>
    <tr><td>NaturallyImmune</td>     <td>Susceptible</td></tr>
    <tr><td>NaturallyImmune</td>     <td>Susceptible</td></tr>
    <tr><td>Susceptible</td>         <td>VaccineImmune</td></tr>
    <tr><td>Susceptible</td>         <td>VaccineImmune</td></tr>
    <tr><td>Susceptible</td>         <td>Destroyed</td></tr>
    <!-- No infectious units, simulation stops. -->
  </output>
</deterministic-test>

<variable-test>
  <category>ring-vaccination</category>
  <short-name>destroyed while waiting 1, check reporting variables</short-name>

  <description>
    Test that the vaccination waiting list is updated correctly when a unit is
    destroyed while awaiting vaccination.  This scenario is identical to
    "destroyed while waiting 1" above.
  </description>

  <author>Neil Harvey &lt;neilharvey@gmail.com&gt;</author>
  <creation-date>10 Oct 2006</creation-date>
  <model-version>3.0</model-version>

  <herd-file>2herds</herd-file>

  <parameter-file>destroyed_while_waiting_1_w_vars</parameter-file>

  <parameter-description>
    The latent period lasts 1 day, infectiousness lasts 3 days, clinical signs
    accompany infectiousness immediately, and natural immunity lasts 3 days.

    There is no spread.
    
    The probability of detecting a diseased unit vs. the number of days the
    animals have been showing clinical signs is fixed at 1. The probability of
    detecting a diseased unit vs. the number of days since a public
    announcement of an outbreak is also fixed at 1.

    At the first detection, vaccination and destruction programs begin.  The
    authorities will both vaccinate and destroy units within 10 km of a
    detected unit.  (This might not be a sensible strategy, but it is a useful
    setup for this test.)  On the first 4 days that vaccinations could occur,
    the vaccination capacity will be zero.  The next day and forward, the
    vaccination capacity is 1 unit per day.  The vaccine produces immunity
    immediately, and the immunity lasts 5 days.

    On the first 6 days that destructions could occur, the destruction capacity
    will be zero.  The next day and forward, the destruction capacity is 1 unit
    per day.

    Recapping what should happen as a result of all this:
     - On day 1 unit 0 will be latent.
     - On day 2 unit 0 will be Infectious Clinical.  It will be detected, and
       unit 1 will be marked for vaccination because it is within 10 km of a
       detected unit.
     - Day 3 is the first day that vaccinations and destructions could happen,
       but there will be no vaccination capacity for 4 days and no destruction
       capacity for 6 days.
     - On day 4 there will be no vaccination capacity for another 3 days, and
       no destruction capacity for another 5 days.
     - On day 5 unit 0 will no longer be infectious.  However, the simulation
       will keep going because there are still vaccination and destruction
       tasks to be done.  There will be no vaccination capacity for another 2
       days, and no destruction capacity for another 4 days.
     - On day 6 there will be no vaccination capacity for another 1 day, and no
       destruction capacity for another 3 days.
     - On day 7 unit 1 will be vaccinated.  There will be no destruction
       capacity for another 2 days.
     - On day 8 unit 1's state will show as Immune.  There will be no
       destruction capacity for another 1 day.
     - On day 9 unit 2 will be destroyed.
     - On day 10 unit 1's state will show as Destroyed.  Because there are no
       infectious units left and nothing left to do, the simulation can end.
  </parameter-description>

  <output>
    <tr>
      <td>num-units-awaiting-vaccination</td>
      <td>num-units-vaccinated</td>
      <td>peak-num-units-awaiting-vaccination</td>
      <td>peak-vaccination-wait-time</td>
      <td>num-units-awaiting-destruction</td>
      <td>num-units-destroyed</td>
    </tr>
    <tr><td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td></tr>
    <tr><td>1</td>  <td>0</td>  <td>1</td>  <td>0</td>  <td>1</td>  <td>0</td></tr>
    <tr><td>1</td>  <td>0</td>  <td>1</td>  <td>1</td>  <td>1</td>  <td>0</td></tr>
    <tr><td>1</td>  <td>0</td>  <td>1</td>  <td>2</td>  <td>1</td>  <td>0</td></tr>
    <tr><td>1</td>  <td>0</td>  <td>1</td>  <td>3</td>  <td>1</td>  <td>0</td></tr>
    <tr><td>1</td>  <td>0</td>  <td>1</td>  <td>4</td>  <td>1</td>  <td>0</td></tr>
    <tr><td>0</td>  <td>1</td>  <td>1</td>  <td>5</td>  <td>1</td>  <td>0</td></tr>
    <tr><td>0</td>  <td>0</td>  <td>1</td>  <td>5</td>  <td>1</td>  <td>0</td></tr>
    <tr><td>0</td>  <td>0</td>  <td>1</td>  <td>5</td>  <td>0</td>  <td>1</td></tr>
    <tr><td>0</td>  <td>0</td>  <td>1</td>  <td>5</td>  <td>0</td>  <td>0</td></tr>
    <!-- No infectious units, simulation stops. -->
  </output>
</variable-test>

<deterministic-test>
  <category>ring-vaccination</category>
  <short-name>destroyed while waiting 2</short-name>

  <description>
    Test that the vaccination waiting list is updated correctly when a unit is
    destroyed while awaiting vaccination.
    
    In the tests "destroyed while waiting" 1-3, there are two units.  Unit 0 is
    infected.  On day 1 unit 0 is detected and unit 1 is marked for both
    vaccination and destruction.  Different effects can be observed when a)
    vaccination happens before destruction, b) destruction happens before
    vaccination, or c) vaccination and destruction actions come up on the same
    day.

    In this scenario, destruction happens before vaccination.
  </description>

  <author>Neil Harvey &lt;neilharvey@gmail.com&gt;</author>
  <creation-date>11 Oct 2006</creation-date>
  <model-version>3.0</model-version>

  <herd-file>2herds</herd-file>

  <parameter-file>destroyed_while_waiting_2</parameter-file>

  <parameter-description>
    The latent period lasts 1 day, infectiousness lasts 3 days, clinical signs
    accompany infectiousness immediately, and natural immunity lasts 3 days.

    There is no spread.
    
    The probability of detecting a diseased unit vs. the number of days the
    animals have been showing clinical signs is fixed at 1. The probability of
    detecting a diseased unit vs. the number of days since a public
    announcement of an outbreak is also fixed at 1.

    At the first detection, vaccination and destruction programs begin.  The
    authorities will both vaccinate and destroy units within 10 km of a
    detected unit.  (This might not be a sensible strategy, but it is a useful
    setup for this test.)  On the first 4 days that vaccinations could occur,
    the vaccination capacity will be zero.  The next day and forward, the
    vaccination capacity is 1 unit per day.  The vaccine produces immunity
    immediately, and the immunity lasts 5 days.

    On the first 3 days that destructions could occur, the destruction capacity
    will be zero.  The next day and forward, the destruction capacity is 1 unit
    per day.

    Recapping what should happen as a result of all this:
     - On day 1 unit 0 will be latent.
     - On day 2 unit 0 will be Infectious Clinical.  It will be detected, and
       unit 1 will be marked for vaccination because it is within 10 km of a
       detected unit.
     - Day 3 is the first day that vaccinations and destructions could happen,
       but there will be no vaccination capacity for 4 days and no destruction
       capacity for 3 days.
     - On day 4 there will be no vaccination capacity for another 3 days, and
       no destruction capacity for another 2 days.
     - On day 5 unit 0 will no longer be infectious.  However, the simulation
       will keep going because there are still vaccination and destruction
       tasks to be done.  There will be no vaccination capacity for another 2
       days, and no destruction capacity for another 1 day.
     - On day 6 unit 1 will be destroyed.  There will be no vaccination
       capacity for another 1 day.
     - On day 7 unit 1's state will show as Destroyed.  Vaccination capacity
       will come on-line, but it no longer matters because the one unit marked
       for vaccination has been destroyed.  Because there are no infectious
       units left and nothing left to do, the simulation can end.
  </parameter-description>

  <output>
    <tr><td>Latent</td>              <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>Susceptible</td></tr>
    <tr><td>NaturallyImmune</td>     <td>Susceptible</td></tr>
    <tr><td>NaturallyImmune</td>     <td>Susceptible</td></tr>
    <tr><td>NaturallyImmune</td>     <td>Destroyed</td></tr>
    <!-- No infectious units, simulation stops. -->
  </output>
</deterministic-test>

<variable-test>
  <category>ring-vaccination</category>
  <short-name>destroyed while waiting 2, check reporting variables</short-name>

  <description>
    Test that the vaccination waiting list is updated correctly when a unit is
    destroyed while awaiting vaccination.  This scenario is identical to
    "destroyed while waiting 2" above.
  </description>

  <author>Neil Harvey &lt;neilharvey@gmail.com&gt;</author>
  <creation-date>11 Oct 2006</creation-date>
  <model-version>3.0</model-version>

  <herd-file>2herds</herd-file>

  <parameter-file>destroyed_while_waiting_2_w_vars</parameter-file>

  <parameter-description>
    The latent period lasts 1 day, infectiousness lasts 3 days, clinical signs
    accompany infectiousness immediately, and natural immunity lasts 3 days.

    There is no spread.
    
    The probability of detecting a diseased unit vs. the number of days the
    animals have been showing clinical signs is fixed at 1. The probability of
    detecting a diseased unit vs. the number of days since a public
    announcement of an outbreak is also fixed at 1.

    At the first detection, vaccination and destruction programs begin.  The
    authorities will both vaccinate and destroy units within 10 km of a
    detected unit.  (This might not be a sensible strategy, but it is a useful
    setup for this test.)  On the first 4 days that vaccinations could occur,
    the vaccination capacity will be zero.  The next day and forward, the
    vaccination capacity is 1 unit per day.  The vaccine produces immunity
    immediately, and the immunity lasts 5 days.

    On the first 3 days that destructions could occur, the destruction capacity
    will be zero.  The next day and forward, the destruction capacity is 1 unit
    per day.

    Recapping what should happen as a result of all this:
     - On day 1 unit 0 will be latent.
     - On day 2 unit 0 will be Infectious Clinical.  It will be detected, and
       unit 1 will be marked for vaccination because it is within 10 km of a
       detected unit.
     - Day 3 is the first day that vaccinations and destructions could happen,
       but there will be no vaccination capacity for 4 days and no destruction
       capacity for 3 days.
     - On day 4 there will be no vaccination capacity for another 3 days, and
       no destruction capacity for another 2 days.
     - On day 5 unit 0 will no longer be infectious.  However, the simulation
       will keep going because there are still vaccination and destruction
       tasks to be done.  There will be no vaccination capacity for another 2
       days, and no destruction capacity for another 1 day.
     - On day 6 unit 1 will be destroyed.  There will be no vaccination
       capacity for another 1 day.
     - On day 7 unit 1's state will show as Destroyed.  Vaccination capacity
       will come on-line, but it no longer matters because the one unit marked
       for vaccination has been destroyed.  Because there are no infectious
       units left and nothing left to do, the simulation can end.
  </parameter-description>

  <output>
    <tr>
      <td>num-units-awaiting-vaccination</td>
      <td>num-units-vaccinated</td>
      <td>peak-num-units-awaiting-vaccination</td>
      <td>peak-vaccination-wait-time</td>
      <td>num-units-awaiting-destruction</td>
      <td>num-units-destroyed</td>
    </tr>
    <tr><td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td></tr>
    <tr><td>1</td>  <td>0</td>  <td>1</td>  <td>0</td>  <td>1</td>  <td>0</td></tr>
    <tr><td>1</td>  <td>0</td>  <td>1</td>  <td>1</td>  <td>1</td>  <td>0</td></tr>
    <tr><td>1</td>  <td>0</td>  <td>1</td>  <td>2</td>  <td>1</td>  <td>0</td></tr>
    <tr><td>1</td>  <td>0</td>  <td>1</td>  <td>3</td>  <td>1</td>  <td>0</td></tr>
    <tr><td>0</td>  <td>0</td>  <td>1</td>  <td>4</td>  <td>0</td>  <td>1</td></tr>
    <tr><td>0</td>  <td>0</td>  <td>1</td>  <td>4</td>  <td>0</td>  <td>0</td></tr>
    <!-- No infectious units, simulation stops. -->
  </output>
</variable-test>

<deterministic-test>
  <category>ring-vaccination</category>
  <short-name>destroyed while waiting 3</short-name>

  <description>
    Test that the vaccination waiting list is updated correctly when a unit is
    destroyed while awaiting vaccination.
    
    In the tests "destroyed while waiting" 1-3, there are two units.  Unit 0 is
    infected.  On day 1 unit 0 is detected and unit 1 is marked for both
    vaccination and destruction.  Different effects can be observed when a)
    vaccination happens before destruction, b) destruction happens before
    vaccination, or c) vaccination and destruction actions come up on the same
    day.

    In this scenario, vaccination and destruction actions come up on the same
    day.
  </description>

  <author>Neil Harvey &lt;neilharvey@gmail.com&gt;</author>
  <creation-date>19 Oct 2006</creation-date>
  <model-version>3.0</model-version>

  <herd-file>2herds</herd-file>

  <parameter-file>destroyed_while_waiting_3</parameter-file>

  <parameter-description>
    The latent period lasts 1 day, infectiousness lasts 3 days, clinical signs
    accompany infectiousness immediately, and natural immunity lasts 3 days.

    There is no spread.
    
    The probability of detecting a diseased unit vs. the number of days the
    animals have been showing clinical signs is fixed at 1. The probability of
    detecting a diseased unit vs. the number of days since a public
    announcement of an outbreak is also fixed at 1.

    At the first detection, vaccination and destruction programs begin.  The
    authorities will both vaccinate and destroy units within 10 km of a
    detected unit.  (This might not be a sensible strategy, but it is a useful
    setup for this test.)  On the first 4 days that vaccinations could occur,
    the vaccination capacity will be zero.  The next day and forward, the
    vaccination capacity is 1 unit per day.  The vaccine produces immunity
    immediately, and the immunity lasts 5 days.

    On the first 4 days that destructions could occur, the destruction capacity
    will be zero.  The next day and forward, the destruction capacity is 1 unit
    per day.

    Recapping what should happen as a result of all this:
     - On day 1 unit 0 will be latent.
     - On day 2 unit 0 will be Infectious Clinical.  It will be detected, and
       unit 1 will be marked for vaccination because it is within 10 km of a
       detected unit.
     - Day 3 is the first day that vaccinations and destructions could happen,
       but there will be no vaccination or destruction capacity for 4 days.
     - On day 4 there will be no vaccination or destruction capacity for
       another 3 days.
     - On day 5 unit 0 will no longer be infectious.  However, the simulation
       will keep going because there are still vaccination and destruction
       tasks to be done.  There will be no vaccination or destruction capacity
       for another 2 days.
     - On day 6 there will be no vaccination or destruction capacity for
       another 1 day.
     - On day 7 both the destruction and vaccination capacity will come
       on-line.  Destruction will preempt vaccination and unit 1 will be
       destroyed.
     - On day 8 unit 1's state will show as Destroyed.  Because there are no
       infectious units left and nothing left to do, the simulation can end.
  </parameter-description>

  <output>
    <tr><td>Latent</td>              <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>Susceptible</td></tr>
    <tr><td>InfectiousClinical</td>  <td>Susceptible</td></tr>
    <tr><td>NaturallyImmune</td>     <td>Susceptible</td></tr>
    <tr><td>NaturallyImmune</td>     <td>Susceptible</td></tr>
    <tr><td>NaturallyImmune</td>     <td>Susceptible</td></tr>
    <tr><td>Susceptible</td>         <td>Destroyed</td></tr>
    <!-- No infectious units, simulation stops. -->
  </output>
</deterministic-test>

<variable-test>
  <category>ring-vaccination</category>
  <short-name>destroyed while waiting 3, check reporting variables</short-name>

  <description>
    Test that the vaccination waiting list is updated correctly when a unit is
    destroyed while awaiting vaccination.  This scenario is identical to
    "destroyed while waiting 3" above.
  </description>

  <author>Neil Harvey &lt;neilharvey@gmail.com&gt;</author>
  <creation-date>19 Oct 2006</creation-date>
  <model-version>3.0</model-version>

  <herd-file>2herds</herd-file>

  <parameter-file>destroyed_while_waiting_3_w_vars</parameter-file>

  <parameter-description>
    The latent period lasts 1 day, infectiousness lasts 3 days, clinical signs
    accompany infectiousness immediately, and natural immunity lasts 3 days.

    There is no spread.
    
    The probability of detecting a diseased unit vs. the number of days the
    animals have been showing clinical signs is fixed at 1. The probability of
    detecting a diseased unit vs. the number of days since a public
    announcement of an outbreak is also fixed at 1.

    At the first detection, vaccination and destruction programs begin.  The
    authorities will both vaccinate and destroy units within 10 km of a
    detected unit.  (This might not be a sensible strategy, but it is a useful
    setup for this test.)  On the first 4 days that vaccinations could occur,
    the vaccination capacity will be zero.  The next day and forward, the
    vaccination capacity is 1 unit per day.  The vaccine produces immunity
    immediately, and the immunity lasts 5 days.

    On the first 4 days that destructions could occur, the destruction capacity
    will be zero.  The next day and forward, the destruction capacity is 1 unit
    per day.

    Recapping what should happen as a result of all this:
     - On day 1 unit 0 will be latent.
     - On day 2 unit 0 will be Infectious Clinical.  It will be detected, and
       unit 1 will be marked for vaccination because it is within 10 km of a
       detected unit.
     - Day 3 is the first day that vaccinations and destructions could happen,
       but there will be no vaccination or destruction capacity for 4 days.
     - On day 4 there will be no vaccination or destruction capacity for
       another 3 days.
     - On day 5 unit 0 will no longer be infectious.  However, the simulation
       will keep going because there are still vaccination and destruction
       tasks to be done.  There will be no vaccination or destruction capacity
       for another 2 days.
     - On day 6 there will be no vaccination or destruction capacity for
       another 1 day.
     - On day 7 both the destruction and vaccination capacity will come
       on-line.  Destruction will preempt vaccination and unit 1 will be
       destroyed.
     - On day 8 unit 1's state will show as Destroyed.  Because there are no
       infectious units left and nothing left to do, the simulation can end.
  </parameter-description>

  <output>
    <tr>
      <td>num-units-awaiting-vaccination</td>
      <td>num-units-vaccinated</td>
      <td>peak-num-units-awaiting-vaccination</td>
      <td>peak-vaccination-wait-time</td>
      <td>num-units-awaiting-destruction</td>
      <td>num-units-destroyed</td>
    </tr>
    <tr><td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td></tr>
    <tr><td>1</td>  <td>0</td>  <td>1</td>  <td>0</td>  <td>1</td>  <td>0</td></tr>
    <tr><td>1</td>  <td>0</td>  <td>1</td>  <td>1</td>  <td>1</td>  <td>0</td></tr>
    <tr><td>1</td>  <td>0</td>  <td>1</td>  <td>2</td>  <td>1</td>  <td>0</td></tr>
    <tr><td>1</td>  <td>0</td>  <td>1</td>  <td>3</td>  <td>1</td>  <td>0</td></tr>
    <tr><td>1</td>  <td>0</td>  <td>1</td>  <td>4</td>  <td>1</td>  <td>0</td></tr>
    <tr><td>0</td>  <td>0</td>  <td>1</td>  <td>5</td>  <td>0</td>  <td>1</td></tr>
    <tr><td>0</td>  <td>0</td>  <td>1</td>  <td>5</td>  <td>0</td>  <td>0</td></tr>
    <!-- No infectious units, simulation stops. -->
  </output>
</variable-test>

<variable-test>
  <category>ring-vaccination</category>
  <short-name>ring at equator</short-name>

  <description>
    This is one of a set of 4 scenarios to check that the ring is drawn
    correctly at all latitudes, and with and without the R-tree index.  In this
    scenario, the ring is at the equator and the R-tree is not used.
  </description>

  <author>Neil Harvey &lt;neilharvey@gmail.com&gt;</author>
  <creation-date>14 May 2007</creation-date>
  <model-version>3.1</model-version>

  <herd-file>no_rtree_lat0</herd-file>

  <parameter-file>lat_and_rtree</parameter-file>

  <parameter-description>
    The latent period lasts 1 day, the infectious clinical period lasts 2 days,
    and immunity lasts 3 days.

    The probability of detection vs. the number of days a unit has been showing
    clinical signs is fixed at 1.  The probability of detection vs. the number
    of days since a public announcement of an outbreak is also fixed at 1.

    When a diseased unit is detected, all units within 1 km will be vaccinated.
    The authorities can vaccinate an unlimited/very large number of units each
    day.

    There is no spread or destruction.

    What should happen:
     - On day 1 the infected unit (unit 0) will be Latent.
     - On day 2 unit 0 will be Infectious Clinical.  It will be detected.  The
       46 units around unit 0 will be marked for vaccination.
     - On day 3 those units will be vaccinated.
  </parameter-description>

  <output>
    <tr>
      <td>num-units-vaccinated-by-reason:ring vaccination</td>
    </tr>
    <tr> <td>0</td></tr>
    <tr> <td>0</td></tr>
    <tr><td>46</td></tr>
    <tr> <td>0</td></tr>
  </output>
</variable-test>

<variable-test>
  <category>ring-vaccination</category>
  <short-name>ring at lat 45</short-name>

  <description>
    This is one of a set of 4 scenarios to check that the ring is drawn
    correctly at all latitudes, and with and without the R-tree index.  In this
    scenario, the ring is at the 45th parallel and the R-tree is not used.
  </description>

  <author>Neil Harvey &lt;neilharvey@gmail.com&gt;</author>
  <creation-date>14 May 2007</creation-date>
  <model-version>3.1</model-version>

  <herd-file>no_rtree_lat45</herd-file>

  <parameter-file>lat_and_rtree</parameter-file>

  <parameter-description>
    The latent period lasts 1 day, the infectious clinical period lasts 2 days,
    and immunity lasts 3 days.

    The probability of detection vs. the number of days a unit has been showing
    clinical signs is fixed at 1.  The probability of detection vs. the number
    of days since a public announcement of an outbreak is also fixed at 1.

    When a diseased unit is detected, all units within 1 km will be vaccinated.
    The authorities can vaccinate an unlimited/very large number of units each
    day.

    There is no spread or destruction.

    What should happen:
     - On day 1 the infected unit (unit 0) will be Latent.
     - On day 2 unit 0 will be Infectious Clinical.  It will be detected.  The
       46 units around unit 0 will be marked for vaccination.
     - On day 3 those units will be vaccinated.
  </parameter-description>

  <output>
    <tr>
      <td>num-units-vaccinated-by-reason:ring vaccination</td>
    </tr>
    <tr> <td>0</td></tr>
    <tr> <td>0</td></tr>
    <tr><td>46</td></tr>
    <tr> <td>0</td></tr>
  </output>
</variable-test>

<variable-test>
  <category>ring-vaccination</category>
  <short-name>ring at equator, using R-tree</short-name>

  <description>
    This is one of a set of 4 scenarios to check that the ring is drawn
    correctly at all latitudes, and with and without the R-tree index.  In this
    scenario, the ring is at the equator and the R-tree is used.
  </description>

  <author>Neil Harvey &lt;neilharvey@gmail.com&gt;</author>
  <creation-date>14 May 2007</creation-date>
  <model-version>3.1</model-version>

  <herd-file>rtree_lat0</herd-file>

  <parameter-file>lat_and_rtree</parameter-file>

  <parameter-description>
    The latent period lasts 1 day, the infectious clinical period lasts 2 days,
    and immunity lasts 3 days.

    The probability of detection vs. the number of days a unit has been showing
    clinical signs is fixed at 1.  The probability of detection vs. the number
    of days since a public announcement of an outbreak is also fixed at 1.

    When a diseased unit is detected, all units within 1 km will be vaccinated.
    The authorities can vaccinate an unlimited/very large number of units each
    day.

    There is no spread or destruction.

    What should happen:
     - On day 1 the infected unit (unit 0) will be Latent.
     - On day 2 unit 0 will be Infectious Clinical.  It will be detected.  The
       46 units around unit 0 will be marked for vaccination.
     - On day 3 those units will be vaccinated.
  </parameter-description>

  <output>
    <tr>
      <td>num-units-vaccinated-by-reason:ring vaccination</td>
    </tr>
    <tr> <td>0</td></tr>
    <tr> <td>0</td></tr>
    <tr><td>46</td></tr>
    <tr> <td>0</td></tr>
  </output>
</variable-test>

<variable-test>
  <category>ring-vaccination</category>
  <short-name>ring at lat 45, using R-tree</short-name>

  <description>
    This is one of a set of 4 scenarios to check that the ring is drawn
    correctly at all latitudes, and with and without the R-tree index.  In this
    scenario, the ring is at the 45th parallel and the R-tree is used.
  </description>

  <author>Neil Harvey &lt;neilharvey@gmail.com&gt;</author>
  <creation-date>14 May 2007</creation-date>
  <model-version>3.1</model-version>

  <herd-file>rtree_lat45</herd-file>

  <parameter-file>lat_and_rtree</parameter-file>

  <parameter-description>
    The latent period lasts 1 day, the infectious clinical period lasts 2 days,
    and immunity lasts 3 days.

    The probability of detection vs. the number of days a unit has been showing
    clinical signs is fixed at 1.  The probability of detection vs. the number
    of days since a public announcement of an outbreak is also fixed at 1.

    When a diseased unit is detected, all units within 1 km will be vaccinated.
    The authorities can vaccinate an unlimited/very large number of units each
    day.

    There is no spread or destruction.

    What should happen:
     - On day 1 the infected unit (unit 0) will be Latent.
     - On day 2 unit 0 will be Infectious Clinical.  It will be detected.  The
       46 units around unit 0 will be marked for vaccination.
     - On day 3 those units will be vaccinated.
  </parameter-description>

  <output>
    <tr>
      <td>num-units-vaccinated-by-reason:ring vaccination</td>
    </tr>
    <tr> <td>0</td></tr>
    <tr> <td>0</td></tr>
    <tr><td>46</td></tr>
    <tr> <td>0</td></tr>
  </output>
</variable-test>
